#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="4ebf1d59-95d6-4a4e-8c22-d8a80a87736b" LowerBound="1.1" HigherBound="311.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Stage2" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="ServiceDeclaration" OID="c04186a5-ba74-45b8-a5fe-a71f9fd82a1a" ParentLink="Module_ServiceDeclaration" LowerBound="11.1" HigherBound="310.1">
            <om:Property Name="InitializedTransactionType" Value="True" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="// Microsoft.Samples.BizTalk.SouthridgeVideo.CableOrderStage2.CableOrder2&#xD;&#xA;// CableOrder2 orchestration in the end to end Business Process Management Scenario.&#xD;&#xA;// &#xD;&#xA;//&#xD;&#xA;// Copyright (c) Microsoft Corporation. All rights reserved.  &#xD;&#xA;// THIS CODE AND INFORMATION ARE PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND, &#xD;&#xA;// EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES &#xD;&#xA;// OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE." />
            <om:Property Name="Name" Value="CableOrder2Orch" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="39e7152d-7ff6-4b68-b71f-58757ae0a18e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="23.1" HigherBound="24.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ServiceOrderActivityID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="343a98ed-cd0d-4039-abbf-4f97836cf87d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="24.1" HigherBound="25.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CustomerOrderActivityID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="LongRunningTransaction" OID="f15f226c-e7d6-4918-983c-e79ab08b219d" ParentLink="ServiceDeclaration_Transaction" LowerBound="12.21" HigherBound="12.61">
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CableOrder2Transaction" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
            <om:Element Type="Compensation" OID="45beefbe-0f71-4ec3-949a-6aed1c86646e" ParentLink="ServiceDeclaration_Compensation" LowerBound="305.1" HigherBound="309.1">
                <om:Property Name="IsCustom" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Compensation_0" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Task" OID="7165abba-3d51-4f52-8a78-5a7aa540284d" ParentLink="Compensation_Statement" LowerBound="308.1" HigherBound="308.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Don't do anything" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
            <om:Element Type="CorrelationDeclaration" OID="8fcfd481-4428-4b08-a784-fd15f8a12850" ParentLink="ServiceDeclaration_CorrelationDeclaration" LowerBound="20.1" HigherBound="21.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="OrderRecvdCorrelation" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="StatementRef" OID="7baa7035-acd7-4f39-aa4d-a20a92be19dc" ParentLink="CorrelationDeclaration_StatementRef" LowerBound="28.126" HigherBound="28.158">
                    <om:Property Name="Initializes" Value="True" />
                    <om:Property Name="Ref" Value="faab01e8-5acf-4ce9-b75e-62801f9b1265" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="StatementRef_2" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="StatementRef" OID="2667abfd-8983-42be-aa1f-9458b40db75c" ParentLink="CorrelationDeclaration_StatementRef" LowerBound="298.78" HigherBound="298.99">
                    <om:Property Name="Initializes" Value="False" />
                    <om:Property Name="Ref" Value="018ffcc3-c4e7-43bf-8483-e6bc67df24d5" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="StatementRef_3" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="StatementRef" OID="aeba6470-1f9e-467a-bb96-3a38815851e0" ParentLink="CorrelationDeclaration_StatementRef" LowerBound="208.81" HigherBound="208.102">
                    <om:Property Name="Initializes" Value="False" />
                    <om:Property Name="Ref" Value="fbed6f2c-4e1d-4cc3-be57-ceb3f682e070" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="StatementRef_4" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="StatementRef" OID="d84ebcf9-b939-47ef-916a-d5efefeb16a7" ParentLink="CorrelationDeclaration_StatementRef" LowerBound="66.53" HigherBound="66.74">
                    <om:Property Name="Initializes" Value="False" />
                    <om:Property Name="Ref" Value="e783b4e8-c222-4887-b9a8-9a0514ec186b" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="StatementRef_5" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c1b600be-650d-4aa1-94dd-45f586d7db7c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="21.1" HigherBound="22.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderMgrMsgType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="OrderMgrMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c79f8d39-db7a-4dd3-beff-673b11d0c472" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="22.1" HigherBound="23.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Terminated" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="TerminatedMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="2fcbc491-270f-40dd-9eb4-38cbef37f3d1" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="faab01e8-5acf-4ce9-b75e-62801f9b1265" ParentLink="ServiceBody_Statement" LowerBound="27.1" HigherBound="31.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Stage2Port" />
                    <om:Property Name="MessageName" Value="OrderMgrMsg" />
                    <om:Property Name="OperationName" Value="Start" />
                    <om:Property Name="OperationMessageName" Value="request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive Order" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DNFPredicate" OID="cc5439e4-f42a-4e3a-b948-9e7578a20791" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.Stage" />
                        <om:Property Name="RHS" Value="2" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="Scope" OID="aa4eac70-5161-4580-af38-80f63e7a4aeb" ParentLink="ServiceBody_Statement" LowerBound="31.1" HigherBound="304.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Global Scope" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableDeclaration" OID="78408823-7376-4ddb-b653-ec0fd2617a59" ParentLink="Scope_VariableDeclaration" LowerBound="38.1" HigherBound="39.1">
                        <om:Property Name="UseDefaultConstructor" Value="True" />
                        <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Routing" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="routingInfo" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableDeclaration" OID="4c3f6211-68bb-4241-9743-349893639f3b" ParentLink="Scope_VariableDeclaration" LowerBound="39.1" HigherBound="40.1">
                        <om:Property Name="UseDefaultConstructor" Value="False" />
                        <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="orderHandler" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="LongRunningTransaction" OID="e597749c-a489-45b8-9d80-9a22608bd6ab" ParentLink="Scope_Transaction" LowerBound="32.18" HigherBound="32.51">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="GlobalTx" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="CorrelationDeclaration" OID="605e2a52-b8ef-4c5c-89d1-389d9f69b652" ParentLink="Scope_CorrelationDeclaration" LowerBound="40.1" HigherBound="41.1">
                        <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="OrderCorrelation" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="StatementRef" OID="299730f8-a7d0-4565-98b1-93ea8658fdb3" ParentLink="CorrelationDeclaration_StatementRef" LowerBound="66.76" HigherBound="66.103">
                            <om:Property Name="Initializes" Value="True" />
                            <om:Property Name="Ref" Value="e783b4e8-c222-4887-b9a8-9a0514ec186b" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="StatementRef_1" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="db5a55e2-c87f-4745-874f-e0be939b1264" ParentLink="ComplexStatement_Statement" LowerBound="44.1" HigherBound="46.1">
                        <om:Property Name="Expression" Value="StageCompletionPort(Microsoft.XLANGs.BaseTypes.Address) = OrderMgrMsg.RoutingPart.OrderMgrReturnAddress;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Assign Address" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Construct" OID="fe6211bd-c472-4aed-a24f-e3a8360c46e4" ParentLink="ComplexStatement_Statement" LowerBound="46.1" HigherBound="57.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Construct Ack &amp; OrderMsg" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="9d20cecf-a29e-4f7e-ae9e-09aa7941ecc7" ParentLink="Construct_MessageRef" LowerBound="47.31" HigherBound="47.37">
                            <om:Property Name="Ref" Value="AckMsg" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="3c29e502-dc65-47ea-a250-a27b8229c30e" ParentLink="Construct_MessageRef" LowerBound="47.39" HigherBound="47.47">
                            <om:Property Name="Ref" Value="OrderMsg" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="944a6aa3-50f3-4046-a007-c9346158fb00" ParentLink="ComplexStatement_Statement" LowerBound="49.1" HigherBound="54.1">
                            <om:Property Name="Expression" Value="AckMsg = new Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.OrderAck();&#xD;&#xA;AckMsg.CustomerID = OrderMgrMsg.RoutingPart.CustomerID;&#xD;&#xA;AckMsg.OrderID = OrderMgrMsg.RoutingPart.OrderID;&#xD;&#xA;AckMsg.Status = OrderMgrMsg.RoutingPart.Status;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Assign Ack" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="4ca4987e-1458-41cd-ba5d-589d6203e855" ParentLink="ComplexStatement_Statement" LowerBound="54.1" HigherBound="56.1">
                            <om:Property Name="Expression" Value="OrderMsg = (System.Xml.XmlDocument)OrderMgrMsg.OrderPart;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Get OrderMsg" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="3ee4b33c-4b91-4c4c-ac74-8b011bcbed8c" ParentLink="ComplexStatement_Statement" LowerBound="57.1" HigherBound="65.1">
                        <om:Property Name="Expression" Value="&#xD;&#xA;System.Diagnostics.Debug.WriteLine( &quot;\n&lt;CABLEORDER2&gt;\n&quot; );&#xD;&#xA;System.Diagnostics.Debug.WriteLine( &quot;   Req ID   : &quot; + OrderMsg.RequestID );&#xD;&#xA;System.Diagnostics.Debug.WriteLine( &quot;   Customer : &quot; + OrderMsg.CustNum );&#xD;&#xA;System.Diagnostics.Debug.WriteLine( &quot;   Order    : &quot; + OrderMsg.OrderNum );&#xD;&#xA;System.Diagnostics.Debug.WriteLine( &quot;   Sequence : &quot; + System.Convert.ToString( OrderMsg.OrderSeqNum ) );&#xD;&#xA;System.Diagnostics.Debug.WriteLine( &quot;\n&lt;/CABLEORDER2&gt;\n&quot; ) ;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="TRACE" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Send" OID="e783b4e8-c222-4887-b9a8-9a0514ec186b" ParentLink="ComplexStatement_Statement" LowerBound="65.1" HigherBound="67.1">
                        <om:Property Name="PortName" Value="Stage2Port" />
                        <om:Property Name="MessageName" Value="AckMsg" />
                        <om:Property Name="OperationName" Value="Start" />
                        <om:Property Name="OperationMessageName" Value="response" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Respond" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="2dfb7c10-f36b-4df3-a941-5a60f7faebf4" ParentLink="ComplexStatement_Statement" LowerBound="67.1" HigherBound="69.1">
                        <om:Property Name="Expression" Value="routingInfo = OrderMgrMsg.RoutingPart;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Save RoutingInfo" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Task" OID="7065afcb-581e-4cc6-8186-ab10c73c9bac" ParentLink="ComplexStatement_Statement" LowerBound="69.1" HigherBound="199.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Business Processing" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="ce42a400-f4c8-4a46-81c1-3fea30a3f28a" ParentLink="ComplexStatement_Statement" LowerBound="69.1" HigherBound="77.1">
                            <om:Property Name="Expression" Value="// [BAM] Continue [CustomerOrderRequest]&#xD;&#xA;&#xD;&#xA;CustomerOrderActivityID = Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.ContinueCollecting(OrderMsg.RequestID);&#xD;&#xA;&#xD;&#xA;// [BAM] Continue [ServiceOrderRequest]&#xD;&#xA;&#xD;&#xA;ServiceOrderActivityID = Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.ContinueCollecting(OrderMsg.RequestID);&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="BAM Continuation" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Scope" OID="7e456402-f1dc-4f6d-bd89-a4c96d4ee08b" ParentLink="ComplexStatement_Statement" LowerBound="77.1" HigherBound="180.1">
                            <om:Property Name="InitializedTransactionType" Value="True" />
                            <om:Property Name="IsSynchronized" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Create Order Handler Scope" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableDeclaration" OID="c329b9cb-4ba5-44ac-aa2e-ff01c1c1fab3" ParentLink="Scope_VariableDeclaration" LowerBound="80.1" HigherBound="81.1">
                                <om:Property Name="UseDefaultConstructor" Value="False" />
                                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SsoConfigHelper" />
                                <om:Property Name="ParamDirection" Value="In" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="configData" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Scope" OID="b8ce5528-44e4-4b30-bc62-eefa3603aa9f" ParentLink="ComplexStatement_Statement" LowerBound="83.1" HigherBound="130.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Calling Code Scope" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableDeclaration" OID="d4ba0386-5b7c-4e04-914f-7750df26e48f" ParentLink="Scope_VariableDeclaration" LowerBound="87.1" HigherBound="88.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Object" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ReturnValue" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="271c7514-4607-4147-b7e6-17f77a3680d8" ParentLink="Scope_VariableDeclaration" LowerBound="88.1" HigherBound="89.1">
                                    <om:Property Name="InitialValue" Value="&quot;CancelFailure&quot;" />
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.String" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Reason" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="79cb1ad5-0fae-48f4-a551-532f223eab64" ParentLink="Scope_VariableDeclaration" LowerBound="89.1" HigherBound="90.1">
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.Array" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParameterArray" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="5dbe86bc-2b1c-4294-a097-cb63bea64cea" ParentLink="Scope_VariableDeclaration" LowerBound="90.1" HigherBound="91.1">
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.String" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MethodName" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="e08f61ef-b884-4374-9ddf-d5446e1b168b" ParentLink="Scope_VariableDeclaration" LowerBound="91.1" HigherBound="92.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Exception" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Ex" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="ce41f156-7819-4f00-9234-ab3ca0f7c5d6" ParentLink="Scope_VariableDeclaration" LowerBound="92.1" HigherBound="93.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Object" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CalledObject" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="e1abf1ff-b0e6-4694-b995-294b38004074" ParentLink="Scope_VariableDeclaration" LowerBound="93.1" HigherBound="94.1">
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.Type" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ObjectType" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="b68ccfcd-3865-44d7-a85e-b144678c9263" ParentLink="ComplexStatement_Statement" LowerBound="101.1" HigherBound="103.1">
                                    <om:Property Name="Expression" Value="configData = Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SsoConfigHelper.Singleton;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Get Config Data" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="53976ea2-fa6b-45ac-b3a2-2bb278765faa" ParentLink="Scope_MessageDeclaration" LowerBound="86.1" HigherBound="87.1">
                                    <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="XmlOrderMsg" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="4e11bb77-fe7a-48fe-910d-c7be2349f7c4" ParentLink="Scope_Catch" LowerBound="106.1" HigherBound="128.1">
                                    <om:Property Name="ExceptionName" Value="CodeEx" />
                                    <om:Property Name="ExceptionType" Value="System.Exception" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Catch Exception" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="VariableAssignment" OID="8441728f-0ade-42b6-b372-d1608f64bdfe" ParentLink="Catch_Statement" LowerBound="109.1" HigherBound="117.1">
                                        <om:Property Name="Expression" Value="Ex = CodeEx;&#xD;&#xA;CalledObject = null;&#xD;&#xA;ObjectType = System.Type.GetType(&quot;Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SSOConfigHelper&quot;);&#xD;&#xA;Reason = &quot;Read SSO failed&quot;;&#xD;&#xA;MethodName = &quot;Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SSOConfigHelper.Singleton&quot;;&#xD;&#xA;ParameterArray = null;&#xD;&#xA;ReturnValue = null;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Initial Exception" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="82a44e5f-5224-40eb-8bc1-d4fa78e156b3" ParentLink="Catch_Statement" LowerBound="117.1" HigherBound="123.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Construct XmlOrderMsg" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="805f461d-2343-4859-ae45-fa0be771be29" ParentLink="Construct_MessageRef" LowerBound="118.51" HigherBound="118.62">
                                            <om:Property Name="Ref" Value="XmlOrderMsg" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="af686b29-0bc0-4d99-b066-9723dd9ea210" ParentLink="ComplexStatement_Statement" LowerBound="120.1" HigherBound="122.1">
                                            <om:Property Name="Expression" Value="XmlOrderMsg = OrderMsg;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="Convert OrderMsg" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Call" OID="d6d67206-dad7-4e19-995e-aef0800da652" ParentLink="Catch_Statement" LowerBound="123.1" HigherBound="125.1">
                                        <om:Property Name="Identifier" Value="CallExceptionHandler_DC" />
                                        <om:Property Name="Invokee" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.ExceptionHandlerOrch" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Call Exception Handler" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Parameter" OID="d6b4e10f-3b15-40eb-ab89-2ee6a57fc96b" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="Reason" />
                                            <om:Property Name="Type" Value="System.String" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="9a2d7aba-93b8-478a-b247-e8a455135d3f" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="Ex" />
                                            <om:Property Name="Type" Value="System.Exception" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="35f36721-7b0c-46d8-a33b-409066a8183d" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="CalledObject" />
                                            <om:Property Name="Type" Value="System.Object" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="5f05adce-f2eb-4bb8-93fd-890f5edb2e45" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="MethodName" />
                                            <om:Property Name="Type" Value="System.String" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="77a5bd32-7f51-4ccc-97b5-4380d736ba62" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="ParameterArray" />
                                            <om:Property Name="Type" Value="System.Array" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="e57dd05c-218b-4411-832d-21ab3f1a326e" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="OrderCorrelation" />
                                            <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="ccb4bdc6-f909-42f5-9986-8dfe89638030" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="XmlOrderMsg" />
                                            <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="90dd431a-0045-46e7-99bd-c8cebbda85c8" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="Out" />
                                            <om:Property Name="Name" Value="ReturnValue" />
                                            <om:Property Name="Type" Value="System.Object" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="41df4264-85e6-4beb-b711-7e25d2519656" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="ObjectType" />
                                            <om:Property Name="Type" Value="System.Type" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="c43ab65a-cfa2-4786-9e8a-ded6a4cd0db3" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="routingInfo" />
                                            <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Routing" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="8c88563e-e1a7-4017-b269-c7c75089443a" ParentLink="Catch_Statement" LowerBound="125.1" HigherBound="127.1">
                                        <om:Property Name="Expression" Value="configData = (Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SsoConfigHelper)ReturnValue;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Get Config Data" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="82561ff1-c080-4bf7-9b22-40320427e60e" ParentLink="ComplexStatement_Statement" LowerBound="130.1" HigherBound="178.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Calling Code Scope (OrderHandler)" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="2a65b209-9727-428c-9b5d-897928867a6f" ParentLink="ComplexStatement_Statement" LowerBound="148.1" HigherBound="150.1">
                                    <om:Property Name="Expression" Value="orderHandler = new Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper( configData.CableProvisioningSystemLocation );" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Create OrderHandler" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="58280154-3303-4876-924e-95218312f591" ParentLink="Scope_VariableDeclaration" LowerBound="134.1" HigherBound="135.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Object" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ReturnValue" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="61763bd2-9aa3-4e70-b174-7837b9b3f1e8" ParentLink="Scope_VariableDeclaration" LowerBound="135.1" HigherBound="136.1">
                                    <om:Property Name="InitialValue" Value="&quot;CancelFailure&quot;" />
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.String" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Reason" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="a4d59259-77a7-4584-94b1-b94e7e5f8af3" ParentLink="Scope_VariableDeclaration" LowerBound="136.1" HigherBound="137.1">
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.Array" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParameterArray" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="4f7d400d-090b-4285-a4d6-6f504b2fd0a6" ParentLink="Scope_VariableDeclaration" LowerBound="137.1" HigherBound="138.1">
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.String" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MethodName" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="39776951-b1a0-4102-82cd-74358dc75efc" ParentLink="Scope_VariableDeclaration" LowerBound="138.1" HigherBound="139.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Exception" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Ex" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="2505e6f2-010a-473a-a52e-46a77c02b581" ParentLink="Scope_VariableDeclaration" LowerBound="139.1" HigherBound="140.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Object" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CalledObject" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="20f10a7a-a1a4-43b3-b7ce-1cf837707db3" ParentLink="Scope_VariableDeclaration" LowerBound="140.1" HigherBound="141.1">
                                    <om:Property Name="UseDefaultConstructor" Value="False" />
                                    <om:Property Name="Type" Value="System.Type" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ObjectType" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="39f2099e-bb53-4868-b2a9-b7269983c6ac" ParentLink="Scope_MessageDeclaration" LowerBound="133.1" HigherBound="134.1">
                                    <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="XmlOrderMsg" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="449c17c6-407d-4123-883f-1f3fa957c4bf" ParentLink="Scope_Catch" LowerBound="153.1" HigherBound="176.1">
                                    <om:Property Name="ExceptionName" Value="CodeEx" />
                                    <om:Property Name="ExceptionType" Value="System.Exception" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Catch Exception" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="VariableAssignment" OID="7da38048-c77a-4ece-9c2c-63c1dc7b7c21" ParentLink="Catch_Statement" LowerBound="156.1" HigherBound="165.1">
                                        <om:Property Name="Expression" Value="Ex = CodeEx;&#xD;&#xA;CalledObject = null;&#xD;&#xA;ObjectType = System.Type.GetType(&quot;Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper&quot;);&#xD;&#xA;Reason = &quot;Construction Failed&quot;;&#xD;&#xA;MethodName = System.String.Empty;&#xD;&#xA;ParameterArray = System.Array.CreateInstance(typeof(System.Object), 1);&#xD;&#xA;ParameterArray.SetValue(configData.CableProvisioningSystemLocation, 0);&#xD;&#xA;ReturnValue = null;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Initial Exception" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="9312eb23-6540-4ed8-a123-15d2acd31b51" ParentLink="Catch_Statement" LowerBound="165.1" HigherBound="171.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Construct XmlOrderMsg" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="24912718-9965-4626-ba60-0a75d5aed5b8" ParentLink="Construct_MessageRef" LowerBound="166.51" HigherBound="166.62">
                                            <om:Property Name="Ref" Value="XmlOrderMsg" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="aa8588d0-dad7-4f05-a07e-634accbadd37" ParentLink="ComplexStatement_Statement" LowerBound="168.1" HigherBound="170.1">
                                            <om:Property Name="Expression" Value="XmlOrderMsg = OrderMsg;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="Convert OrderMsg" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Call" OID="3cfabf0e-b998-4b48-94ca-572a8027c5eb" ParentLink="Catch_Statement" LowerBound="171.1" HigherBound="173.1">
                                        <om:Property Name="Identifier" Value="CallOrchestration_1" />
                                        <om:Property Name="Invokee" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.ExceptionHandlerOrch" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Call Exception Handler" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Parameter" OID="3dfa7e16-723c-4cfa-a9d6-6853af1b2f7d" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="Reason" />
                                            <om:Property Name="Type" Value="System.String" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="60f35705-2fa1-4dd2-a147-b8923e9e0070" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="Ex" />
                                            <om:Property Name="Type" Value="System.Exception" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="ae4188ee-cc5b-4ca0-82e9-6c503ad07152" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="CalledObject" />
                                            <om:Property Name="Type" Value="System.Object" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="021799b7-0026-48c5-ae6f-7306ddd2e8be" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="MethodName" />
                                            <om:Property Name="Type" Value="System.String" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="8891164e-298e-4c54-b002-cd00f93ff0aa" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="ParameterArray" />
                                            <om:Property Name="Type" Value="System.Array" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="ce21e388-1c0a-4d2e-a47d-9d4d88fb11ef" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="OrderCorrelation" />
                                            <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="6b118f64-32d9-4363-9fcd-15e40b947d0d" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="XmlOrderMsg" />
                                            <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="666e40f9-a459-4c3c-800a-81f6f7f5706d" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="Out" />
                                            <om:Property Name="Name" Value="ReturnValue" />
                                            <om:Property Name="Type" Value="System.Object" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="557f9542-9868-4deb-93d8-3855de6ee6e5" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="ObjectType" />
                                            <om:Property Name="Type" Value="System.Type" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Parameter" OID="5e58932a-fa41-4bd1-a393-5c7d85cb030d" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="routingInfo" />
                                            <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Routing" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="a339cd4f-755a-47a2-a6ad-8327b8673654" ParentLink="Catch_Statement" LowerBound="173.1" HigherBound="175.1">
                                        <om:Property Name="Expression" Value="orderHandler = (Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper)ReturnValue;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Get OrderHandler" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Call" OID="a7c3ee6f-87c1-4a16-b1bf-7b09a491e1e7" ParentLink="ComplexStatement_Statement" LowerBound="180.1" HigherBound="182.1">
                            <om:Property Name="Identifier" Value="CallCheckInterrupt" />
                            <om:Property Name="Invokee" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.CheckInterruptOrch" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Check Interrupt" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Parameter" OID="37369c82-987f-4400-98bd-b1e0aa37bafc" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="OrderCorrelation" />
                                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Call" OID="c7f7b4df-3ecc-487b-a2e2-5c38c73d2a82" ParentLink="ComplexStatement_Statement" LowerBound="182.1" HigherBound="184.1">
                            <om:Property Name="Identifier" Value="CallComplete" />
                            <om:Property Name="Invokee" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.CableOrderActions.Complete" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Call Complete" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Parameter" OID="b2f82f3e-3001-411e-bf46-d9363a4f2c11" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="OrderMsg" />
                                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.OrderSchema" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Parameter" OID="8fe69873-182f-43e9-aaaa-8c331e8d24b3" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="orderHandler" />
                                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Parameter" OID="39e516a5-be47-44a8-b7ef-fd4f2d7a7b0f" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="OrderCorrelation" />
                                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Parameter" OID="4d3697fb-9e82-472b-b6fe-43c5c7ecc488" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="routingInfo" />
                                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Routing" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="4ceea8f7-04bf-4a16-a6c9-9e065bbda3fb" ParentLink="ComplexStatement_Statement" LowerBound="184.1" HigherBound="189.1">
                            <om:Property Name="Expression" Value="&#xD;&#xA;// [BAM] Update Activity [ServiceorderRequest] with [CompletedService]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.CompletedService( ServiceOrderActivityID );&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="BAM Activated" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Construct" OID="7e98fd1d-622f-4a97-a75a-6de61be8373b" ParentLink="ComplexStatement_Statement" LowerBound="189.1" HigherBound="199.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct Completion Msgs" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="c50dd720-2625-4b77-8cd6-4d92f9fa9f59" ParentLink="Construct_MessageRef" LowerBound="190.31" HigherBound="190.47">
                                <om:Property Name="Ref" Value="CompleteOrderMsg" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="ea9ba32f-6d07-4a11-8ad3-4af4d7b6ffc7" ParentLink="Construct_MessageRef" LowerBound="190.49" HigherBound="190.62">
                                <om:Property Name="Ref" Value="CompletionMsg" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="303dbc65-c175-463e-b8d3-6cf5a0f3ef79" ParentLink="ComplexStatement_Statement" LowerBound="192.1" HigherBound="195.1">
                                <om:Property Name="Expression" Value="CompleteOrderMsg = OrderMsg;&#xD;&#xA;CompleteOrderMsg.Status = &quot;COMPLETED&quot;;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Update Status" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="7b6665ba-a7ec-4cb2-9eb7-99c6afc2da2d" ParentLink="ComplexStatement_Statement" LowerBound="195.1" HigherBound="198.1">
                                <om:Property Name="Expression" Value="CompletionMsg = OrderMgrMsg;&#xD;&#xA;CompletionMsg.OrderPart = (System.Xml.XmlDocument)CompleteOrderMsg;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Assign Parts" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Scope" OID="57f24cd3-b046-4bff-85d3-02a88aa7f4f3" ParentLink="ComplexStatement_Statement" LowerBound="199.1" HigherBound="211.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Efficient Send Scope" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="AtomicTransaction" OID="22a00e6b-9c2e-4647-8b2f-0815cf408a09" ParentLink="Scope_Transaction" LowerBound="201.26" HigherBound="201.70">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="EfficientSendTransaction" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Task" OID="41b1f81a-0581-4030-a419-89b2273e3bba" ParentLink="ComplexStatement_Statement" LowerBound="205.1" HigherBound="207.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Business Processing" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Send" OID="208b86ec-eb00-4e0b-9a4d-918af5023a96" ParentLink="ComplexStatement_Statement" LowerBound="205.1" HigherBound="207.1">
                                <om:Property Name="PortName" Value="UpdateHistoryPort" />
                                <om:Property Name="MessageName" Value="CompleteOrderMsg" />
                                <om:Property Name="OperationName" Value="Update" />
                                <om:Property Name="OperationMessageName" Value="OrderMsg" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Update History" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="fbed6f2c-4e1d-4cc3-be57-ceb3f682e070" ParentLink="ComplexStatement_Statement" LowerBound="207.1" HigherBound="209.1">
                            <om:Property Name="PortName" Value="StageCompletionPort" />
                            <om:Property Name="MessageName" Value="CompletionMsg" />
                            <om:Property Name="OperationName" Value="Completed" />
                            <om:Property Name="OperationMessageName" Value="request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Part2 Complete" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="TransactionAttribute" OID="1cc4e398-6703-43e1-8993-ff64e9a13d38" ParentLink="Statement_CLRAttribute" LowerBound="200.1" HigherBound="201.1">
                            <om:Property Name="Batch" Value="True" />
                            <om:Property Name="Retry" Value="True" />
                            <om:Property Name="Timeout" Value="60" />
                            <om:Property Name="Isolation" Value="Serializable" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="8a39bf43-cbf5-4a26-b456-05e67456f5da" ParentLink="ComplexStatement_Statement" LowerBound="211.1" HigherBound="216.1">
                        <om:Property Name="Expression" Value="&#xD;&#xA;// [BAM] Update Activity [Customer Order Request] with [Update History DB]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.UpdatedHistory( CustomerOrderActivityID );&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="BAM Upd History" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="488d3bdd-a49c-4650-a002-1fa9feff2aa5" ParentLink="ComplexStatement_Statement" LowerBound="216.1" HigherBound="220.1">
                        <om:Property Name="Expression" Value="// [BAM] Update Activity [ServiceorderRequest] with [EndOrder]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndOrder( ServiceOrderActivityID );&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="BAM End Order" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="0bc15d5f-a956-42d5-93c6-5fac654196fa" ParentLink="ComplexStatement_Statement" LowerBound="220.1" HigherBound="230.1">
                        <om:Property Name="Expression" Value="&#xD;&#xA;// [BAM] End collecting BAM data [Customer Order Request]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.EndCollecting( CustomerOrderActivityID );&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;// [BAM] End collecting BAM data [ServiceOrderRequest]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndCollecting( ServiceOrderActivityID );&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="BAM End" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="MessageDeclaration" OID="cc784796-1751-4bd6-b924-f58a8ce88d3b" ParentLink="Scope_MessageDeclaration" LowerBound="34.1" HigherBound="35.1">
                        <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.OrderSchema" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="OrderMsg" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="MessageDeclaration" OID="b5ad6d19-7928-4738-a1aa-35bded2b5796" ParentLink="Scope_MessageDeclaration" LowerBound="35.1" HigherBound="36.1">
                        <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.OrderSchema" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CompleteOrderMsg" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="MessageDeclaration" OID="7f8c49b6-0a9e-4364-ad1d-38dc140b9667" ParentLink="Scope_MessageDeclaration" LowerBound="36.1" HigherBound="37.1">
                        <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.OrderAck" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="AckMsg" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="MessageDeclaration" OID="9b337ad3-df02-468e-b193-682ed133d9bf" ParentLink="Scope_MessageDeclaration" LowerBound="37.1" HigherBound="38.1">
                        <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderMgrMsgType" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CompletionMsg" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Catch" OID="c4893017-547a-4686-93fb-403b7034fdb6" ParentLink="Scope_Catch" LowerBound="233.1" HigherBound="260.1">
                        <om:Property Name="ExceptionName" Value="interruptEx" />
                        <om:Property Name="ExceptionType" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.InterruptException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch Interrupt Exception" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="fff4f2cd-8a24-44b5-88b8-9e75e887e87d" ParentLink="Catch_Statement" LowerBound="236.1" HigherBound="238.1">
                            <om:Property Name="Expression" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.ErrorHandler.PostWarning( &quot;CableOrder2 terminated because: Interrupted&quot; );&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Log Error" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="d6db8e86-b94e-4fbe-a4bd-650825857d7f" ParentLink="Catch_Statement" LowerBound="238.1" HigherBound="247.1">
                            <om:Property Name="Expression" Value="&#xD;&#xA;// [BAM] Update Activity [ServiceorderRequest] with [Terminated]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.Terminated( ServiceOrderActivityID );&#xD;&#xA;&#xD;&#xA;// [BAM] Update Activity [Service Order Request] with [Error]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.ErrorOccurred( ServiceOrderActivityID, &quot;CableOrder2 Interrupted&quot; );&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="BAM Terminate" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="19e68d00-d6b4-4a84-8d4a-9228944e8394" ParentLink="Catch_Statement" LowerBound="247.1" HigherBound="257.1">
                            <om:Property Name="Expression" Value="&#xD;&#xA;// [BAM] End collecting BAM data [Customer Order Request]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.EndCollecting( CustomerOrderActivityID );&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;// [BAM] End collecting BAM data [ServiceOrderRequest]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndCollecting( ServiceOrderActivityID );&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="BAM End" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Terminate" OID="0263ed5b-2aa6-43e7-a072-08c878c0549b" ParentLink="Catch_Statement" LowerBound="257.1" HigherBound="259.1">
                            <om:Property Name="ErrorMessage" Value="&quot;Interrupted&quot;;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Terminate" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="4882f000-96c4-4e9b-8dce-0e42c92fb4df" ParentLink="Scope_Catch" LowerBound="260.1" HigherBound="302.1">
                        <om:Property Name="ExceptionName" Value="globalEx" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch Exceptions" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="c692c7f5-3c43-4ec1-9725-12eef938cf1c" ParentLink="Catch_Statement" LowerBound="263.1" HigherBound="265.1">
                            <om:Property Name="Expression" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.ErrorHandler.PostError( &quot;CableOrder2 terminated because: &quot; + globalEx.Message );&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Log Error" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="c59b2429-cd84-4400-85b6-45087b55a0f2" ParentLink="Catch_Statement" LowerBound="265.1" HigherBound="278.1">
                            <om:Property Name="Expression" Value="&#xD;&#xA;// [BAM] Update Activity [ServiceorderRequest] with [Terminated]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.Terminated( ServiceOrderActivityID );&#xD;&#xA;&#xD;&#xA;// [BAM] Update Activity [Customer Order Request] with [Error]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.ErrorOccurred( CustomerOrderActivityID, globalEx.Message );&#xD;&#xA;&#xD;&#xA;// [BAM] Update Activity [Service Order Request] with [Error]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.ErrorOccurred( ServiceOrderActivityID, globalEx.Message );&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="BAM Terminate" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="fd4ff8f2-8bdc-438e-b8ad-e0ff91ee92f3" ParentLink="Catch_Statement" LowerBound="278.1" HigherBound="288.1">
                            <om:Property Name="Expression" Value="&#xD;&#xA;// [BAM] End collecting BAM data [Customer Order Request]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.EndCollecting( CustomerOrderActivityID );&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;// [BAM] End collecting BAM data [ServiceOrderRequest]&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndCollecting( ServiceOrderActivityID );&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="BAM End" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="9b075f8b-93e5-4744-8bca-f7ad1165b361" ParentLink="Catch_Statement" LowerBound="288.1" HigherBound="297.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct TerminatedMsg" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="1a95efca-8df3-4a96-8bf5-97844fce8911" ParentLink="Construct_MessageRef" LowerBound="289.35" HigherBound="289.48">
                                <om:Property Name="Ref" Value="TerminatedMsg" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="690ee47c-00a9-4f7f-83f4-1930d22ce0c7" ParentLink="ComplexStatement_Statement" LowerBound="291.1" HigherBound="296.1">
                                <om:Property Name="Expression" Value="TerminatedMsg = new Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Terminated();&#xD;&#xA;TerminatedMsg.CustomerID = OrderMgrMsg.RoutingPart.CustomerID;&#xD;&#xA;TerminatedMsg.OrderID = OrderMgrMsg.RoutingPart.OrderID;&#xD;&#xA;TerminatedMsg.Status = globalEx.Message;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Assign Error" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="018ffcc3-c4e7-43bf-8483-e6bc67df24d5" ParentLink="Catch_Statement" LowerBound="297.1" HigherBound="299.1">
                            <om:Property Name="PortName" Value="StageCompletionPort" />
                            <om:Property Name="MessageName" Value="TerminatedMsg" />
                            <om:Property Name="OperationName" Value="Terminated" />
                            <om:Property Name="OperationMessageName" Value="request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send TerminatedMsg" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Terminate" OID="3c7b9805-9376-42c9-b83f-eab39c89a1cf" ParentLink="Catch_Statement" LowerBound="299.1" HigherBound="301.1">
                            <om:Property Name="ErrorMessage" Value="&quot;Exception thrown in CableOrder2: &quot; + globalEx.Message;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Terminate" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="75b9e46a-be8a-41e4-a0fa-fc5ea88402bd" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="14.1" HigherBound="16.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="14" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.StageBeginPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Stage2Port" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="DirectBindingAttribute" OID="57880c07-63b1-40b9-9e44-f267f698c800" ParentLink="PortDeclaration_CLRAttribute" LowerBound="14.1" HigherBound="15.1">
                    <om:Property Name="PartnerPort" Value="StagePort" />
                    <om:Property Name="PartnerService" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderManagerOrch" />
                    <om:Property Name="DirectBindingType" Value="PartnerPort" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="b92c8a36-7e2b-4032-8b8a-431288bd6143" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="16.1" HigherBound="18.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="199" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Stage2.UpdateHistoryPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="UpdateHistoryPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="138b4ae1-d580-4897-8ce7-704bea2fbf65" ParentLink="PortDeclaration_CLRAttribute" LowerBound="16.1" HigherBound="17.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a5b3afc4-3573-404e-b9b3-32be6e15d05e" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="18.1" HigherBound="20.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="200" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.StageCompletionPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="StageCompletionPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="DirectBindingAttribute" OID="38d4237c-cc0c-4b42-b205-95d1c9736e36" ParentLink="PortDeclaration_CLRAttribute" LowerBound="18.1" HigherBound="19.1">
                    <om:Property Name="PartnerPort" Value="StageCompletionPort" />
                    <om:Property Name="PartnerService" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Stage2.CableOrder2Orch" />
                    <om:Property Name="DirectBindingType" Value="PartnerPort" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="ec93dd28-1aaf-40dc-bb06-137c4a01aee0" ParentLink="Module_PortType" LowerBound="4.1" HigherBound="11.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="UpdateHistoryPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4f770367-9a70-4db9-a998-d0b83e5f27a2" ParentLink="PortType_OperationDeclaration" LowerBound="6.1" HigherBound="10.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Update" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="16cb7526-7379-4f44-8f72-3913cac49052" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="8.13" HigherBound="8.74">
                    <om:Property Name="Ref" Value="Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.OrderSchema" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="OrderMsg" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
    <om:Element Type="PrintElement" OID="f58fa35c-6d96-4f43-9932-fe4d760bdd5f">
        <om:Property Name="Bottom" Value="0" />
        <om:Property Name="FooterBottom" Value="0" />
        <om:Property Name="FooterCenter" Value="0" />
        <om:Property Name="FooterMargin" Value="0" />
        <om:Property Name="FooterTop" Value="0" />
        <om:Property Name="HeaderBottom" Value="0" />
        <om:Property Name="HeaderCenter" Value="3" />
        <om:Property Name="HeaderMargin" Value="0" />
        <om:Property Name="HeaderTop" Value="0" />
        <om:Property Name="Left" Value="0" />
        <om:Property Name="PagesAcross" Value="0" />
        <om:Property Name="PagesDown" Value="0" />
        <om:Property Name="Right" Value="0" />
        <om:Property Name="Scaling" Value="75" />
        <om:Property Name="Top" Value="0" />
        <om:Property Name="Orientation" Value="Portrait" />
        <om:Property Name="Signal" Value="False" />
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Microsoft.Samples.BizTalk.SouthridgeVideo.Stage2
{
    internal porttype UpdateHistoryPortType
    {
        oneway Update
        {
            Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.OrderSchema
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service longrunning transaction CableOrder2Orch
    {
        [Microsoft.XLANGs.BaseTypes.DirectBinding(typeof(Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderManagerOrch), "StagePort")]
        port implements Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.StageBeginPortType Stage2Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses UpdateHistoryPortType UpdateHistoryPort;
        [Microsoft.XLANGs.BaseTypes.DirectBinding(typeof(Microsoft.Samples.BizTalk.SouthridgeVideo.Stage2.CableOrder2Orch), "StageCompletionPort")]
        port uses Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.StageCompletionPortType StageCompletionPort;
        correlation Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType OrderRecvdCorrelation;
        message Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderMgrMsgType OrderMgrMsg;
        message Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Terminated TerminatedMsg;
        System.String ServiceOrderActivityID;
        System.String CustomerOrderActivityID;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("faab01e8-5acf-4ce9-b75e-62801f9b1265")]
            activate ((Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.Stage == 2))receive (Stage2Port.Start, OrderMgrMsg, initialize OrderRecvdCorrelation);
            ServiceOrderActivityID = "";
            CustomerOrderActivityID = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("aa4eac70-5161-4580-af38-80f63e7a4aeb")]
            scope longrunning transaction GlobalTx
            {
                message Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.OrderSchema OrderMsg;
                message Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.OrderSchema CompleteOrderMsg;
                message Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.OrderAck AckMsg;
                message Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderMgrMsgType CompletionMsg;
                Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Routing routingInfo;
                Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper orderHandler;
                correlation Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.OrderCorrelationType OrderCorrelation;
                body
                {
                    routingInfo = new Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Routing();
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("db5a55e2-c87f-4745-874f-e0be939b1264")]
                    StageCompletionPort(Microsoft.XLANGs.BaseTypes.Address) = OrderMgrMsg.RoutingPart.OrderMgrReturnAddress;
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("fe6211bd-c472-4aed-a24f-e3a8360c46e4")]
                    construct AckMsg, OrderMsg
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("944a6aa3-50f3-4046-a007-c9346158fb00")]
                        AckMsg = new Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.OrderAck();
                        AckMsg.CustomerID = OrderMgrMsg.RoutingPart.CustomerID;
                        AckMsg.OrderID = OrderMgrMsg.RoutingPart.OrderID;
                        AckMsg.Status = OrderMgrMsg.RoutingPart.Status;
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4ca4987e-1458-41cd-ba5d-589d6203e855")]
                        OrderMsg = (System.Xml.XmlDocument)OrderMgrMsg.OrderPart;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3ee4b33c-4b91-4c4c-ac74-8b011bcbed8c")]
                    
                    System.Diagnostics.Debug.WriteLine( "\n<CABLEORDER2>\n" );
                    System.Diagnostics.Debug.WriteLine( "   Req ID   : " + OrderMsg.RequestID );
                    System.Diagnostics.Debug.WriteLine( "   Customer : " + OrderMsg.CustNum );
                    System.Diagnostics.Debug.WriteLine( "   Order    : " + OrderMsg.OrderNum );
                    System.Diagnostics.Debug.WriteLine( "   Sequence : " + System.Convert.ToString( OrderMsg.OrderSeqNum ) );
                    System.Diagnostics.Debug.WriteLine( "\n</CABLEORDER2>\n" ) ;
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e783b4e8-c222-4887-b9a8-9a0514ec186b")]
                    send (Stage2Port.Start, AckMsg, OrderRecvdCorrelation, initialize OrderCorrelation);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2dfb7c10-f36b-4df3-a941-5a60f7faebf4")]
                    routingInfo = OrderMgrMsg.RoutingPart;
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ce42a400-f4c8-4a46-81c1-3fea30a3f28a")]
                    // [BAM] Continue [CustomerOrderRequest]
                    
                    CustomerOrderActivityID = Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.ContinueCollecting(OrderMsg.RequestID);
                    
                    // [BAM] Continue [ServiceOrderRequest]
                    
                    ServiceOrderActivityID = Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.ContinueCollecting(OrderMsg.RequestID);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7e456402-f1dc-4f6d-bd89-a4c96d4ee08b")]
                    scope
                    {
                        Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SsoConfigHelper configData;
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b8ce5528-44e4-4b30-bc62-eefa3603aa9f")]
                            scope
                            {
                                message System.Xml.XmlDocument XmlOrderMsg;
                                System.Object ReturnValue;
                                System.String Reason;
                                System.Array ParameterArray;
                                System.String MethodName;
                                System.Exception Ex;
                                System.Object CalledObject;
                                System.Type ObjectType;
                                body
                                {
                                    ReturnValue = new System.Object();
                                    Reason = "CancelFailure";
                                    MethodName = "";
                                    Ex = new System.Exception();
                                    CalledObject = new System.Object();
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b68ccfcd-3865-44d7-a85e-b144678c9263")]
                                    configData = Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SsoConfigHelper.Singleton;
                                }
                                exceptions
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4e11bb77-fe7a-48fe-910d-c7be2349f7c4")]
                                    catch (System.Exception CodeEx)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8441728f-0ade-42b6-b372-d1608f64bdfe")]
                                        Ex = CodeEx;
                                        CalledObject = null;
                                        ObjectType = System.Type.GetType("Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SSOConfigHelper");
                                        Reason = "Read SSO failed";
                                        MethodName = "Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SSOConfigHelper.Singleton";
                                        ParameterArray = null;
                                        ReturnValue = null;
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("82a44e5f-5224-40eb-8bc1-d4fa78e156b3")]
                                        construct XmlOrderMsg
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("af686b29-0bc0-4d99-b066-9723dd9ea210")]
                                            XmlOrderMsg = OrderMsg;
                                        }
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d6d67206-dad7-4e19-995e-aef0800da652")]
                                        call Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.ExceptionHandlerOrch (Reason, Ex, CalledObject, MethodName, ParameterArray, OrderCorrelation, XmlOrderMsg, out ReturnValue, ObjectType, routingInfo);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8c88563e-e1a7-4017-b269-c7c75089443a")]
                                        configData = (Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.SsoConfigHelper)ReturnValue;
                                    }
                                }
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("82561ff1-c080-4bf7-9b22-40320427e60e")]
                            scope
                            {
                                message System.Xml.XmlDocument XmlOrderMsg;
                                System.Object ReturnValue;
                                System.String Reason;
                                System.Array ParameterArray;
                                System.String MethodName;
                                System.Exception Ex;
                                System.Object CalledObject;
                                System.Type ObjectType;
                                body
                                {
                                    ReturnValue = new System.Object();
                                    Reason = "CancelFailure";
                                    MethodName = "";
                                    Ex = new System.Exception();
                                    CalledObject = new System.Object();
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2a65b209-9727-428c-9b5d-897928867a6f")]
                                    orderHandler = new Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper( configData.CableProvisioningSystemLocation );
                                }
                                exceptions
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("449c17c6-407d-4123-883f-1f3fa957c4bf")]
                                    catch (System.Exception CodeEx)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7da38048-c77a-4ece-9c2c-63c1dc7b7c21")]
                                        Ex = CodeEx;
                                        CalledObject = null;
                                        ObjectType = System.Type.GetType("Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper");
                                        Reason = "Construction Failed";
                                        MethodName = System.String.Empty;
                                        ParameterArray = System.Array.CreateInstance(typeof(System.Object), 1);
                                        ParameterArray.SetValue(configData.CableProvisioningSystemLocation, 0);
                                        ReturnValue = null;
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9312eb23-6540-4ed8-a123-15d2acd31b51")]
                                        construct XmlOrderMsg
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("aa8588d0-dad7-4f05-a07e-634accbadd37")]
                                            XmlOrderMsg = OrderMsg;
                                        }
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3cfabf0e-b998-4b48-94ca-572a8027c5eb")]
                                        call Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.ExceptionHandlerOrch (Reason, Ex, CalledObject, MethodName, ParameterArray, OrderCorrelation, XmlOrderMsg, out ReturnValue, ObjectType, routingInfo);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a339cd4f-755a-47a2-a6ad-8327b8673654")]
                                        orderHandler = (Microsoft.Samples.BizTalk.SouthridgeVideo.CableProvisioningSystem.OrderHandlerWrapper)ReturnValue;
                                    }
                                }
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a7c3ee6f-87c1-4a16-b1bf-7b09a491e1e7")]
                    call Microsoft.Samples.BizTalk.SouthridgeVideo.OrderManager.CheckInterruptOrch (OrderCorrelation);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c7f7b4df-3ecc-487b-a2e2-5c38c73d2a82")]
                    call Microsoft.Samples.BizTalk.SouthridgeVideo.CableOrderActions.Complete (OrderMsg, orderHandler, OrderCorrelation, routingInfo);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4ceea8f7-04bf-4a16-a6c9-9e065bbda3fb")]
                    
                    // [BAM] Update Activity [ServiceorderRequest] with [CompletedService]
                    
                    Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.CompletedService( ServiceOrderActivityID );
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7e98fd1d-622f-4a97-a75a-6de61be8373b")]
                    construct CompleteOrderMsg, CompletionMsg
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("303dbc65-c175-463e-b8d3-6cf5a0f3ef79")]
                        CompleteOrderMsg = OrderMsg;
                        CompleteOrderMsg.Status = "COMPLETED";
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7b6665ba-a7ec-4cb2-9eb7-99c6afc2da2d")]
                        CompletionMsg = OrderMgrMsg;
                        CompletionMsg.OrderPart = (System.Xml.XmlDocument)CompleteOrderMsg;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("57f24cd3-b046-4bff-85d3-02a88aa7f4f3")]
                    [Microsoft.XLANGs.BaseTypes.Transaction(Retry=true,Batch=true,Timeout=60,TranIsolationLevel=System.Data.IsolationLevel.Serializable)]
                    scope atomic transaction EfficientSendTransaction
                    {
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("208b86ec-eb00-4e0b-9a4d-918af5023a96")]
                            send (UpdateHistoryPort.Update, CompleteOrderMsg);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fbed6f2c-4e1d-4cc3-be57-ceb3f682e070")]
                            send (StageCompletionPort.Completed, CompletionMsg, OrderRecvdCorrelation);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8a39bf43-cbf5-4a26-b456-05e67456f5da")]
                    
                    // [BAM] Update Activity [Customer Order Request] with [Update History DB]
                    
                    Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.UpdatedHistory( CustomerOrderActivityID );
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("488d3bdd-a49c-4650-a002-1fa9feff2aa5")]
                    // [BAM] Update Activity [ServiceorderRequest] with [EndOrder]
                    
                    Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndOrder( ServiceOrderActivityID );
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0bc15d5f-a956-42d5-93c6-5fac654196fa")]
                    
                    // [BAM] End collecting BAM data [Customer Order Request]
                    
                    Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.EndCollecting( CustomerOrderActivityID );
                    
                    
                    // [BAM] End collecting BAM data [ServiceOrderRequest]
                    
                    Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndCollecting( ServiceOrderActivityID );
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c4893017-547a-4686-93fb-403b7034fdb6")]
                    catch (Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.InterruptException interruptEx)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fff4f2cd-8a24-44b5-88b8-9e75e887e87d")]
                        Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.ErrorHandler.PostWarning( "CableOrder2 terminated because: Interrupted" );
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d6db8e86-b94e-4fbe-a4bd-650825857d7f")]
                        
                        // [BAM] Update Activity [ServiceorderRequest] with [Terminated]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.Terminated( ServiceOrderActivityID );
                        
                        // [BAM] Update Activity [Service Order Request] with [Error]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.ErrorOccurred( ServiceOrderActivityID, "CableOrder2 Interrupted" );
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("19e68d00-d6b4-4a84-8d4a-9228944e8394")]
                        
                        // [BAM] End collecting BAM data [Customer Order Request]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.EndCollecting( CustomerOrderActivityID );
                        
                        
                        // [BAM] End collecting BAM data [ServiceOrderRequest]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndCollecting( ServiceOrderActivityID );
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0263ed5b-2aa6-43e7-a072-08c878c0549b")]
                        terminate "Interrupted";;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4882f000-96c4-4e9b-8dce-0e42c92fb4df")]
                    catch (System.Exception globalEx)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c692c7f5-3c43-4ec1-9725-12eef938cf1c")]
                        Microsoft.Samples.BizTalk.SouthridgeVideo.Utilities.ErrorHandler.PostError( "CableOrder2 terminated because: " + globalEx.Message );
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c59b2429-cd84-4400-85b6-45087b55a0f2")]
                        
                        // [BAM] Update Activity [ServiceorderRequest] with [Terminated]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.Terminated( ServiceOrderActivityID );
                        
                        // [BAM] Update Activity [Customer Order Request] with [Error]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.ErrorOccurred( CustomerOrderActivityID, globalEx.Message );
                        
                        // [BAM] Update Activity [Service Order Request] with [Error]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.ErrorOccurred( ServiceOrderActivityID, globalEx.Message );
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fd4ff8f2-8bdc-438e-b8ad-e0ff91ee92f3")]
                        
                        // [BAM] End collecting BAM data [Customer Order Request]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.CustomerOrderRequest.EndCollecting( CustomerOrderActivityID );
                        
                        
                        // [BAM] End collecting BAM data [ServiceOrderRequest]
                        
                        Microsoft.Samples.BizTalk.SouthridgeVideo.ServiceLevelTracking.ServiceOrderRequest.EndCollecting( ServiceOrderActivityID );
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9b075f8b-93e5-4744-8bca-f7ad1165b361")]
                        construct TerminatedMsg
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("690ee47c-00a9-4f7f-83f4-1930d22ce0c7")]
                            TerminatedMsg = new Microsoft.Samples.BizTalk.SouthridgeVideo.SchemaClasses.Terminated();
                            TerminatedMsg.CustomerID = OrderMgrMsg.RoutingPart.CustomerID;
                            TerminatedMsg.OrderID = OrderMgrMsg.RoutingPart.OrderID;
                            TerminatedMsg.Status = globalEx.Message;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("018ffcc3-c4e7-43bf-8483-e6bc67df24d5")]
                        send (StageCompletionPort.Terminated, TerminatedMsg, OrderRecvdCorrelation);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3c7b9805-9376-42c9-b83f-eab39c89a1cf")]
                        terminate "Exception thrown in CableOrder2: " + globalEx.Message;;
                    }
                }
            }
        }
        [Microsoft.XLANGs.BaseTypes.DesignerPosition("45beefbe-0f71-4ec3-949a-6aed1c86646e")]
        compensation ()
        {
        }
    }
}

