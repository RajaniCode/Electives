#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="f743a864-8c19-4c3b-8590-a07330dd9f8e" LowerBound="1.1" HigherBound="475.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="e759999f-b408-4545-ae60-6c84d17ee436" ParentLink="Module_PortType" LowerBound="4.1" HigherBound="11.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CustomerServicePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="d48e4da3-482a-4c9f-9980-0036d7075d7a" ParentLink="PortType_OperationDeclaration" LowerBound="6.1" HigherBound="10.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetAccountInfo" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="702021b0-55b0-4c58-80f5-d9c7553313fe" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="8.13" HigherBound="8.83">
                    <om:Property Name="Ref" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceRequest" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="a62de741-9400-4ace-8f02-b4542d6e260a" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="8.85" HigherBound="8.156">
                    <om:Property Name="Ref" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="297e2116-e15b-4313-995d-1ad14936f1ad" ParentLink="Module_PortType" LowerBound="11.1" HigherBound="18.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PaymentTrackingSystemRequestPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="837871d0-c49f-414c-9eec-a5be9e596ec9" ParentLink="PortType_OperationDeclaration" LowerBound="13.1" HigherBound="17.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendPmtTrackRequest" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="9f38c1b0-96d4-4bbd-a626-0a36fa97d37e" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="15.13" HigherBound="15.79">
                    <om:Property Name="Ref" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentRequest" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="bb12dd25-6b69-424a-9cb4-10186db7384b" ParentLink="Module_PortType" LowerBound="18.1" HigherBound="25.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PaymentTrackingSystemResponsePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4fb1e78c-8740-4a3b-a98d-effdd9aacafb" ParentLink="PortType_OperationDeclaration" LowerBound="20.1" HigherBound="24.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ReceivePmtTrackRespone" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="f9e1fd95-a3f8-46f9-b4e1-d643e37140e4" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="22.13" HigherBound="22.80">
                    <om:Property Name="Ref" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="35d754cb-8565-42b4-b8fd-4cb08ac55409" ParentLink="Module_PortType" LowerBound="25.1" HigherBound="32.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SAPPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="9ab27476-befc-497a-8f09-76764405de4b" ParentLink="PortType_OperationDeclaration" LowerBound="27.1" HigherBound="31.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SAPRequestResponse" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="40fb8eeb-861a-48ee-a155-fe74cec857bf" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="29.13" HigherBound="29.118">
                    <om:Property Name="Ref" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="911ae426-73fd-4a43-a47e-910f6792d0fe" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="29.120" HigherBound="29.226">
                    <om:Property Name="Ref" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Response" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="d168a515-6d9f-4c80-a013-ace57a1671b7" ParentLink="Module_ServiceDeclaration" LowerBound="36.1" HigherBound="474.1">
            <om:Property Name="InitializedTransactionType" Value="True" />
            <om:Property Name="IsInvokable" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="// Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.CustomerService&#xD;&#xA;// Customer Service orchestration in the end to end Service Oriented Scenario.&#xD;&#xA;// &#xD;&#xA;//&#xD;&#xA;// Copyright (c) Microsoft Corporation. All rights reserved.  &#xD;&#xA;// THIS CODE AND INFORMATION ARE PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND, &#xD;&#xA;// EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES &#xD;&#xA;// OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE." />
            <om:Property Name="Name" Value="CustomerService" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="bc30f0ca-52b4-4f44-8777-fe64e66053d4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="58.1" HigherBound="59.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a7edb1d8-cb37-4dc1-a4e7-0b325a534399" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="59.1" HigherBound="60.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="customerName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f8354bc2-d3c7-40ac-90d1-25a9222df71f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="60.1" HigherBound="61.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="zipCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fd143cd4-4c9f-4de2-899e-b448f94c588e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="61.1" HigherBound="62.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="RequestIsValid" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="24b70af5-40ba-42e9-93b3-93188b640d1f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="62.1" HigherBound="63.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="errorLastPayments" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="555e8943-6ea7-4965-afbc-f0a882d9003c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="63.1" HigherBound="64.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="errorPendingTransactions" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="85cec902-6a8e-4467-8a04-8d7f43e5bd73" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="64.1" HigherBound="65.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="errorCreditLimit" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c1e34c52-69ae-4055-84f7-05272719e448" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="65.1" HigherBound="66.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="beginCreditLimitTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7e134336-874f-4b89-a819-6530498c9c97" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="66.1" HigherBound="67.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="endCreditLimitTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="69e4eacf-7d18-46e1-8b2a-03f76317a2e8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="67.1" HigherBound="68.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="beginLastPaymentTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6f7501d2-fb04-4b34-97bc-577234390506" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="68.1" HigherBound="69.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="endLastPaymentTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3c54a4ec-2f5e-4e18-9448-32b3b6566f9b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="69.1" HigherBound="70.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="beginPendingTransTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d513484a-a575-40ac-864b-14bd8aab588f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="70.1" HigherBound="71.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="endPendingTransTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1da2f013-67d5-4290-bcdc-bde986c7b592" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="71.1" HigherBound="72.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.TimeSpan" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="creditLimitDuration" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1270ba83-8cdb-4078-846a-a44d460f5edd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="72.1" HigherBound="73.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.TimeSpan" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="lastPaymentDuration" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7ede12a0-02a9-4383-b429-5d0b992d87d5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="73.1" HigherBound="74.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.TimeSpan" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="pendingTransDuration" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9e5f9566-fd11-4546-a1f6-85e421358c2b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="74.1" HigherBound="75.1">
                <om:Property Name="InitialValue" Value="null" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="activityID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b8010821-d8fb-4f4d-a116-3cd05578b434" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="75.1" HigherBound="76.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="beginTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c39aa76f-f4a2-4d7f-8d90-9cb3c5bba3c6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="76.1" HigherBound="77.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="endTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d06752af-a4ef-4372-bf12-39fbd89871c7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="77.1" HigherBound="78.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.TimeSpan" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="timeTaken" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="335488ef-518b-45a4-b960-a1a7441c6a17" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="78.1" HigherBound="79.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sapReturnCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0bf4062b-6c35-47c6-8f31-2a963f7ac8b0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="79.1" HigherBound="80.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sapTimeout" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="14f2a53d-93da-4e98-a867-92cae7aa09ab" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="80.1" HigherBound="81.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="pendTransTimeout" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d0472052-1961-43dc-81f2-c0c00953ae8e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="81.1" HigherBound="82.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="pmntTrackTimeout" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="LongRunningTransaction" OID="06ddf0fd-d20c-418a-b5c8-4c379994efeb" ParentLink="ServiceDeclaration_Transaction" LowerBound="37.21" HigherBound="37.61">
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CustomerServiceBusinessProcess" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
            <om:Element Type="CorrelationDeclaration" OID="4b761d04-6aca-4501-960f-ce4f57d90c60" ParentLink="ServiceDeclaration_CorrelationDeclaration" LowerBound="47.1" HigherBound="48.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.PaymentTrackingSystemCorrelationType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PaymentTrackingSystemCorrelation" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="StatementRef" OID="5a3a2123-32a0-49bf-9b25-541811b9ec46" ParentLink="CorrelationDeclaration_StatementRef" LowerBound="260.113" HigherBound="260.156">
                    <om:Property Name="Initializes" Value="True" />
                    <om:Property Name="Ref" Value="86e01136-5dc3-4cdb-ba81-5b436c87a245" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="StatementRef_1" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="StatementRef" OID="d5d4cc79-48cc-4418-ad97-0464c025fab4" ParentLink="CorrelationDeclaration_StatementRef" LowerBound="265.131" HigherBound="265.163">
                    <om:Property Name="Initializes" Value="False" />
                    <om:Property Name="Ref" Value="53a8c1fb-5e5b-4409-9152-b5dcdf23bb41" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="StatementRef_2" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cc8c5dc3-fd94-4c49-9a92-2b4cfbf9f7dc" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="48.1" HigherBound="49.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="LastPaymentRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9f493cad-606a-4ac8-bef0-d6295cdceea0" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="49.1" HigherBound="50.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="LastPaymentResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="fbb4f775-afcb-45de-baa2-504206e5f7bb" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="50.1" HigherBound="51.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.PendTransWS.PendingTransactionsWebService_.GetPendingTransactions_request" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PendingTransactionsWSRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="51852511-b09d-4d3a-b88c-dc5092dc2510" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="51.1" HigherBound="52.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.PendTransWS.PendingTransactionsWebService_.GetPendingTransactions_response" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PendingTransactionsWSResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="461d35b8-66f7-47d9-a09c-73dd5a6ac457" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="52.1" HigherBound="53.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Request" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CreditLimitRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a62f606e-7507-46ca-920e-ca6e150a2b7f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="53.1" HigherBound="54.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Response" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CreditLimitResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d1774591-5425-49b2-84f8-b06072dc667f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="54.1" HigherBound="55.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.PendingTransactionsRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PendingTransactionsRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="65fa1551-d3bb-4808-ad6a-25683d231b7b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="55.1" HigherBound="56.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.PendingTransactionsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PendingTransactionsResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a14f2446-c554-48f8-8ced-28a9eb79391a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="56.1" HigherBound="57.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.StubSAPWS.StubSAPWS_.GetAccountDetails_request" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="StubSAPWebServiceRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="b1d73b1e-b99a-45e8-9ad6-475c25123041" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="57.1" HigherBound="58.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.StubSAPWS.StubSAPWS_.GetAccountDetails_response" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="StubSAPWebServiceResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="a3cc254f-22a2-48a0-95d9-788ea1320c82" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageDeclaration" OID="ee659c09-9ccb-45a4-90bc-03fb0bf3dfac" ParentLink="ServiceBody_Declaration" LowerBound="82.15" HigherBound="82.116">
                    <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceRequest" />
                    <om:Property Name="ParamDirection" Value="In" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="CustomerServiceRequest" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageDeclaration" OID="5cc7c42c-8ff0-4fcf-92f0-c66c1475692d" ParentLink="ServiceBody_Declaration" LowerBound="82.118" HigherBound="82.225">
                    <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceResponse" />
                    <om:Property Name="ParamDirection" Value="Out" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="CustomerServiceResponse" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="fd1b8c03-9639-45f2-a5d8-4ec620f6f729" ParentLink="ServiceBody_Statement" LowerBound="93.1" HigherBound="472.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="HandleExceptions" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="LongRunningTransaction" OID="39017f42-f592-47d7-ae10-fc1c4f1d9183" ParentLink="Scope_Transaction" LowerBound="94.18" HigherBound="94.69">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CustomerServiceTransaction" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="1be60852-ac5a-451f-8512-48e7b37bf9a8" ParentLink="ComplexStatement_Statement" LowerBound="98.1" HigherBound="109.1">
                        <om:Property Name="Expression" Value="// Begin the BAM activity&#xD;&#xA;&#xD;&#xA;activityID = Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.BeginRequest(CustomerServiceRequest.RequestSource, CustomerServiceRequest.RequestType);&#xD;&#xA;&#xD;&#xA;// Save starting time for later computing response times...&#xD;&#xA;beginTime = System.DateTime.Now;&#xD;&#xA;&#xD;&#xA;// Request Received Milestone&#xD;&#xA;Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestReceived(activityID);&#xD;&#xA;        " />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="BeginActivity" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="130f66ca-1ac6-4b47-b0a7-ae2875d2ff1c" ParentLink="ComplexStatement_Statement" LowerBound="109.1" HigherBound="122.1">
                        <om:Property Name="Expression" Value="sapTimeout = System.Convert.ToInt32 (&#xD;&#xA;        Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.GetConfigParameter(&#xD;&#xA;            Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.SsoConfigParameter.SapAdapterTimeout),&#xD;&#xA;        System.Globalization.CultureInfo.CurrentCulture);&#xD;&#xA;pendTransTimeout = System.Convert.ToInt32(&#xD;&#xA;        Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.GetConfigParameter(&#xD;&#xA;            Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.SsoConfigParameter.PendingTransactionsAdapterTimeout),&#xD;&#xA;        System.Globalization.CultureInfo.CurrentCulture);&#xD;&#xA;pmntTrackTimeout = System.Convert.ToInt32(&#xD;&#xA;        Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.GetConfigParameter(&#xD;&#xA;            Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.SsoConfigParameter.PaymentTrackingAdapterTimeout),&#xD;&#xA;        System.Globalization.CultureInfo.CurrentCulture);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="GetTimeoutValues" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="618154cb-f61d-4a73-8ab5-064e94804239" ParentLink="ComplexStatement_Statement" LowerBound="122.1" HigherBound="131.1">
                        <om:Property Name="Expression" Value="// Validate the input request based on the contents of the AuthenticationInfo element.&#xD;&#xA;// The AuthenticationInfo elements contains name/value pairs for authenticating the customer&#xD;&#xA;// We must either have a ZipCode or a CustomerName to declare that this a valid request.&#xD;&#xA;// Validating the message based on the contents of the request is done in one or more&#xD;&#xA;// of the back end systems...&#xD;&#xA;&#xD;&#xA;customerName  = xpath(CustomerServiceRequest, &#xD;&#xA;&quot;string(/*[local-name()='CustomerServiceRequest']/*[local-name()='Body']/*[local-name()='AuthenticationInfo'][DataElementName='CustomerName']/*[local-name()='DataElementValue'])&quot;);&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ExtractCustomerName" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="60cf248e-f3e1-4140-8206-cf7a44606e1f" ParentLink="ComplexStatement_Statement" LowerBound="131.1" HigherBound="136.1">
                        <om:Property Name="Expression" Value="//Get the zipCode out of the message...&#xD;&#xA;&#xD;&#xA;zipCode = xpath(CustomerServiceRequest, &#xD;&#xA;&quot;string(/*[local-name()='CustomerServiceRequest']/*[local-name()='Body']/*[local-name()='AuthenticationInfo'][DataElementName='ZipCode']/*[local-name()='DataElementValue'])&quot;);&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ExtractZipCode" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="b7f38687-db78-4561-b29b-4395ef2d1d3d" ParentLink="ComplexStatement_Statement" LowerBound="136.1" HigherBound="140.1">
                        <om:Property Name="Expression" Value="//Get the Account Number out of the message...&#xD;&#xA;&#xD;&#xA;accountNumber = CustomerServiceRequest.Body.AccountNumber;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ExtractAccountNumber" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="38ded481-39cf-494e-b7eb-4c7bcb85d0f2" ParentLink="ComplexStatement_Statement" LowerBound="140.1" HigherBound="148.1">
                        <om:Property Name="Expression" Value="// One of the authentication values must be there in the message in order to proceed&#xD;&#xA;// And the account number must be there also.&#xD;&#xA;// And the account number must be valid...&#xD;&#xA;RequestIsValid = (zipCode != &quot;&quot; || customerName != &quot;&quot;) &amp;&amp; &#xD;&#xA;                    accountNumber != &quot;&quot; &amp;&amp;&#xD;&#xA;                    Microsoft.Samples.BizTalk.WoodgroveBank.Utilities.CustomerServiceHelper.IsAccountNumberValid(accountNumber) ;&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ValidateRequest" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Decision" OID="a906930a-c276-4e60-8dee-82e85786f2bb" ParentLink="ComplexStatement_Statement" LowerBound="148.1" HigherBound="430.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="IsRequestValid" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="6e14364b-4934-43a6-9ee8-04eac3591a4b" ParentLink="ReallyComplexStatement_Branch" LowerBound="149.21" HigherBound="411.1">
                            <om:Property Name="Expression" Value="RequestIsValid " />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="IsValid" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Parallel" OID="fa8184fc-286c-4670-916a-11e9f805a7f5" ParentLink="ComplexStatement_Statement" LowerBound="151.1" HigherBound="379.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CollectAccountInformations" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="ParallelBranch" OID="2841199c-4553-4cd9-a17d-8f9ea0765454" ParentLink="ReallyComplexStatement_Branch" LowerBound="156.1" HigherBound="237.1">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParallelBranch_1" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="e5169b60-24d6-4885-af33-74d9102ed252" ParentLink="ComplexStatement_Statement" LowerBound="156.1" HigherBound="164.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructCreditLimitRequest" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Transform" OID="cb744ab2-e9b3-4b23-9c31-587adb18ce5c" ParentLink="ComplexStatement_Statement" LowerBound="159.1" HigherBound="161.1">
                                            <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CreditLimiRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="CreateCreditLimitRequest" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="MessagePartRef" OID="0ba47a43-0a0b-4458-937a-b2dea0394dda" ParentLink="Transform_InputMessagePartRef" LowerBound="160.160" HigherBound="160.182">
                                                <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_3" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="6f06e2f8-62e9-4a40-98d3-3bb215234fcb" ParentLink="Transform_OutputMessagePartRef" LowerBound="160.48" HigherBound="160.66">
                                                <om:Property Name="MessageRef" Value="CreditLimitRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_4" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="07a32244-fdf2-45df-ad56-c8fafa998950" ParentLink="ComplexStatement_Statement" LowerBound="161.1" HigherBound="163.1">
                                            <om:Property Name="Expression" Value="StubSAPWebServiceRequest.BAPI_BANKACCT_GET_DETAIL_Request = CreditLimitRequest;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="CreateWSRequest" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="54cb0bd0-2a6d-47a9-b298-4cbf04d41164" ParentLink="Construct_MessageRef" LowerBound="157.43" HigherBound="157.61">
                                            <om:Property Name="Ref" Value="CreditLimitRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="6426d680-aab2-41cd-b6c3-368bf40f2b14" ParentLink="Construct_MessageRef" LowerBound="157.63" HigherBound="157.87">
                                            <om:Property Name="Ref" Value="StubSAPWebServiceRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="2afe7bce-0978-49fe-b1be-cd744645d460" ParentLink="ComplexStatement_Statement" LowerBound="164.1" HigherBound="166.1">
                                        <om:Property Name="Expression" Value="beginCreditLimitTime = System.DateTime.Now;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="AssignBeginTime" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Send" OID="8661661c-ee61-4718-868a-64f00a60960d" ParentLink="ComplexStatement_Statement" LowerBound="166.1" HigherBound="168.1">
                                        <om:Property Name="PortName" Value="StubSAPWebServicePort" />
                                        <om:Property Name="MessageName" Value="StubSAPWebServiceRequest" />
                                        <om:Property Name="OperationName" Value="GetAccountDetails" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="SendCreditLimitRequest" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Scope" OID="ba9f57c2-44d7-4eff-88dd-7fca8f0b19a7" ParentLink="ComplexStatement_Statement" LowerBound="168.1" HigherBound="214.1">
                                        <om:Property Name="InitializedTransactionType" Value="True" />
                                        <om:Property Name="IsSynchronized" Value="False" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="SAPTimeoutDetectionScope" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="LongRunningTransaction" OID="0ef2d576-8d40-4e55-b1da-2b69759cdc9e" ParentLink="Scope_Transaction" LowerBound="169.38" HigherBound="169.144">
                                            <om:Property Name="TimeoutExpression" Value="new System.TimeSpan(0, 0, 0, 0, sapTimeout )" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ReceiveSAPResponseWithinTime" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Receive" OID="bd87bfd0-ecdd-4f63-9390-b109101bf0b2" ParentLink="ComplexStatement_Statement" LowerBound="173.1" HigherBound="175.1">
                                            <om:Property Name="Activate" Value="False" />
                                            <om:Property Name="PortName" Value="StubSAPWebServicePort" />
                                            <om:Property Name="MessageName" Value="StubSAPWebServiceResponse" />
                                            <om:Property Name="OperationName" Value="GetAccountDetails" />
                                            <om:Property Name="OperationMessageName" Value="Response" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ReceiveCreditLimitResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="f181fd4e-d148-40c5-9d7d-beefc8573fda" ParentLink="ComplexStatement_Statement" LowerBound="175.1" HigherBound="181.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="CreateCreditLimitResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="3f0a1087-3e71-4f31-aabd-35e6cbcbd12c" ParentLink="ComplexStatement_Statement" LowerBound="178.1" HigherBound="180.1">
                                                <om:Property Name="Expression" Value="CreditLimitResponse = StubSAPWebServiceResponse.GetAccountDetailsResult;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="RetriveResultFromWSResponse" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="6f9107eb-1d7c-4c28-bf4d-67a895e17b9e" ParentLink="Construct_MessageRef" LowerBound="176.51" HigherBound="176.70">
                                                <om:Property Name="Ref" Value="CreditLimitResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="cbe12065-a1d1-45ee-8bdd-8ac586ab85bd" ParentLink="ComplexStatement_Statement" LowerBound="181.1" HigherBound="188.1">
                                            <om:Property Name="Expression" Value="// Examine the SAP return code&#xD;&#xA;&#xD;&#xA;sapReturnCode = (System.String) xpath(CreditLimitResponse, &#xD;&#xA;&quot;string(/*[local-name()='BAPI_BANKACCT_GET_DETAIL_Response']/*[local-name()='E_RC'])&quot;);&#xD;&#xA;&#xD;&#xA;errorCreditLimit = sapReturnCode != &quot;&quot;;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ExamineForError" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Catch" OID="4a269b78-ebe2-44e2-802c-255f0f38ef94" ParentLink="Scope_Catch" LowerBound="191.1" HigherBound="212.1">
                                            <om:Property Name="ExceptionName" Value="sapTimeoutException" />
                                            <om:Property Name="ExceptionType" Value="Microsoft.XLANGs.BaseTypes.TimeoutException" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="SAPTimeoutHandler" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="806b0e50-c920-4416-aada-c4b32c6028e2" ParentLink="Catch_Statement" LowerBound="194.1" HigherBound="198.1">
                                                <om:Property Name="Expression" Value="errorCreditLimit = true;&#xD;&#xA;&#xD;&#xA;sapReturnCode = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.SapTimeoutErrorCode() ;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="AssignTimeoutError" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="VariableAssignment" OID="e98d186c-5480-4047-9e14-9cd9c559af67" ParentLink="Catch_Statement" LowerBound="198.1" HigherBound="200.1">
                                                <om:Property Name="Expression" Value="System.Diagnostics.Trace.WriteLine(&quot;Timeout from SAP&quot;);&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Trace" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="ce80b779-0457-4dc7-839a-2927743656e0" ParentLink="Catch_Statement" LowerBound="200.1" HigherBound="206.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructCreditLimitResponeMessage" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="Transform" OID="26da375a-e313-43e7-86ca-bbbaed50b7a3" ParentLink="ComplexStatement_Statement" LowerBound="203.1" HigherBound="205.1">
                                                    <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CreditLimitResponse" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="CreateCreditLimitResponseMessage" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="9f07a8b4-0665-4d05-a032-6965f93a7c09" ParentLink="Transform_InputMessagePartRef" LowerBound="204.175" HigherBound="204.197">
                                                        <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_23" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="77cf53d9-f518-44fc-85f0-1f7120e43be2" ParentLink="Transform_OutputMessagePartRef" LowerBound="204.60" HigherBound="204.79">
                                                        <om:Property Name="MessageRef" Value="CreditLimitResponse" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_24" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="6fda6ad1-5d03-4439-900f-d7ab4ac71c2c" ParentLink="Construct_MessageRef" LowerBound="201.55" HigherBound="201.74">
                                                    <om:Property Name="Ref" Value="CreditLimitResponse" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="VariableAssignment" OID="56ec757c-a262-4927-883f-100f0ed0d429" ParentLink="Catch_Statement" LowerBound="206.1" HigherBound="211.1">
                                                <om:Property Name="Expression" Value="System.Diagnostics.Trace.WriteLine(&quot;Constructed SAP Response Message&quot;);&#xD;&#xA;&#xD;&#xA;//xd1 = CreditLimitResponse ;&#xD;&#xA;//System.Diagnostics.Trace.Write(&quot;CreditLimitResponse = &quot; + xd1.OuterXml);&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Trace" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="bcb6269f-e823-436f-8cfd-71a71579f727" ParentLink="ComplexStatement_Statement" LowerBound="214.1" HigherBound="237.1">
                                        <om:Property Name="Expression" Value="endCreditLimitTime = System.DateTime.Now;&#xD;&#xA;creditLimitDuration = endCreditLimitTime.Subtract(beginCreditLimitTime);&#xD;&#xA;&#xD;&#xA;// Create the appropriate BAM milestones...&#xD;&#xA;if (errorCreditLimit)&#xD;&#xA;{&#xD;&#xA;    // Map SAP return code to appropriate descriptions here...&#xD;&#xA;&#xD;&#xA;    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackCreditLimitError&#xD;&#xA;       (&#xD;&#xA;           activityID, &#xD;&#xA;           System.Convert.ToInt32(creditLimitDuration.TotalMilliseconds),&#xD;&#xA;           sapReturnCode,&#xD;&#xA;           Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.DecodeSapErrorCodeToDescription(sapReturnCode),&#xD;&#xA;           Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.DecodeSapErrorCodeToSource(sapReturnCode)&#xD;&#xA;       );       &#xD;&#xA;}&#xD;&#xA;else&#xD;&#xA;{&#xD;&#xA;    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackCreditLimitSuccess(activityID, &#xD;&#xA;          System.Convert.ToInt32(creditLimitDuration.TotalMilliseconds));&#xD;&#xA;}&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="CreateBAMMilestone" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="ParallelBranch" OID="db69bce4-1eab-4000-a2bd-8d4ce59f203c" ParentLink="ReallyComplexStatement_Branch" LowerBound="240.1" HigherBound="304.1">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParallelBranch_2" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="85e96c88-a9d9-453e-ae0a-5262afe657ee" ParentLink="ComplexStatement_Statement" LowerBound="240.1" HigherBound="257.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructLastPaymentRequest" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Transform" OID="21089c4b-bf08-469e-bf30-9fc772892925" ParentLink="ComplexStatement_Statement" LowerBound="243.1" HigherBound="245.1">
                                            <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_LastPaymentRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="CreateLastPaymentRequest" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessagePartRef" OID="f098257a-b409-4ed9-b877-2b46dc03441d" ParentLink="Transform_InputMessagePartRef" LowerBound="244.161" HigherBound="244.183">
                                                <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_5" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="3017761a-8896-45c3-86c0-7a3212360603" ParentLink="Transform_OutputMessagePartRef" LowerBound="244.48" HigherBound="244.66">
                                                <om:Property Name="MessageRef" Value="LastPaymentRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_6" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="116fbcee-e496-4a6e-b05b-0aae90c154c8" ParentLink="ComplexStatement_Statement" LowerBound="245.1" HigherBound="256.1">
                                            <om:Property Name="Expression" Value="// Assign the MQSerirs Message ID and Correlation ID&#xD;&#xA;// Generate a unique id for the message. MQ Series message ids are 48 characters long.&#xD;&#xA;LastPaymentRequest(MQSeries.MQMD_MsgId) = Microsoft.Samples.BizTalk.WoodgroveBank.Utilities.CustomerServiceHelper.NewUniqueIdAppendToLength(48, '0');&#xD;&#xA;LastPaymentRequest(MQSeries.MQMD_CorrelId) = LastPaymentRequest(MQSeries.MQMD_MsgId);&#xD;&#xA;&#xD;&#xA;// Copy the SSO Ticket and the originator SID to the message so SSO can&#xD;&#xA;// happily redeem the ticket later.&#xD;&#xA;LastPaymentRequest(BTS.SSOTicket) = CustomerServiceRequest(BTS.SSOTicket);&#xD;&#xA;LastPaymentRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID) = CustomerServiceRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID);&#xD;&#xA;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="78e1b03f-6f22-47e0-a9d1-a21ad74ead24" ParentLink="Construct_MessageRef" LowerBound="241.43" HigherBound="241.61">
                                            <om:Property Name="Ref" Value="LastPaymentRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="39967bb6-4dd3-4453-b118-99546b29931c" ParentLink="ComplexStatement_Statement" LowerBound="257.1" HigherBound="259.1">
                                        <om:Property Name="Expression" Value="beginLastPaymentTime = System.DateTime.Now;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="AssignBeginTime" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Send" OID="86e01136-5dc3-4cdb-ba81-5b436c87a245" ParentLink="ComplexStatement_Statement" LowerBound="259.1" HigherBound="261.1">
                                        <om:Property Name="PortName" Value="PaymentTrackingSystemRequestPort" />
                                        <om:Property Name="MessageName" Value="LastPaymentRequest" />
                                        <om:Property Name="OperationName" Value="SendPmtTrackRequest" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="SendRequestToPaymentTrackingSystem" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Listen" OID="e2dfc04c-e627-4aca-9fe6-4c51b01cd51d" ParentLink="ComplexStatement_Statement" LowerBound="261.1" HigherBound="285.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ListenForPmntTrackResponseWithTimeout" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="ListenBranch" OID="19369538-ee05-401f-87e0-b51b082c6c5b" ParentLink="ReallyComplexStatement_Branch" LowerBound="261.1" HigherBound="261.1">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ListenBranch_1" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="2db9b3da-2100-4802-bf11-629a060fc22d" ParentLink="ComplexStatement_Statement" LowerBound="267.1" HigherBound="270.1">
                                                <om:Property Name="Expression" Value="// Check for errors&#xD;&#xA;errorLastPayments = LastPaymentResponse.ResponseStatus.Error.ErrorNumber != &quot;0000&quot;;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ExamineForError" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Receive" OID="53a8c1fb-5e5b-4409-9152-b5dcdf23bb41" ParentLink="ListenBranch_Statement" LowerBound="264.1" HigherBound="265.164">
                                                <om:Property Name="Activate" Value="False" />
                                                <om:Property Name="PortName" Value="PaymentTrackingSystemResponsePort" />
                                                <om:Property Name="MessageName" Value="LastPaymentResponse" />
                                                <om:Property Name="OperationName" Value="ReceivePmtTrackRespone" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ReceiveResponseFromPaymentTrackingSystem" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="ListenBranch" OID="0bf48935-7e25-4cb3-942d-a083fa952584" ParentLink="ReallyComplexStatement_Branch" LowerBound="261.1" HigherBound="261.1">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ListenBranch_2" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="f2aff78b-eae2-464b-a90e-ab385b65070b" ParentLink="ComplexStatement_Statement" LowerBound="275.1" HigherBound="277.1">
                                                <om:Property Name="Expression" Value="errorLastPayments = true;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="AssignTimeoutError" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="c6ac8d1d-a8a2-473d-b588-d9c8b24104fe" ParentLink="ComplexStatement_Statement" LowerBound="277.1" HigherBound="283.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="AssembleResponseMessageWithError" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="Transform" OID="7dfaa9cc-e408-4d4e-9672-71f773885f54" ParentLink="ComplexStatement_Statement" LowerBound="280.1" HigherBound="282.1">
                                                    <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_LastPaymentResponseTimeout" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="CreateLastPaymentResponse" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessagePartRef" OID="e3785094-23ee-4900-9c79-9ee465ec1a98" ParentLink="Transform_InputMessagePartRef" LowerBound="281.178" HigherBound="281.200">
                                                        <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_21" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="506dc9eb-204c-427f-8758-27524f550a59" ParentLink="Transform_OutputMessagePartRef" LowerBound="281.56" HigherBound="281.75">
                                                        <om:Property Name="MessageRef" Value="LastPaymentResponse" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_22" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="917752bd-4572-4829-9796-aa81debd5d0d" ParentLink="Construct_MessageRef" LowerBound="278.51" HigherBound="278.70">
                                                    <om:Property Name="Ref" Value="LastPaymentResponse" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Delay" OID="a1553520-6bd2-4c78-bfa2-3d66c2ba0888" ParentLink="ListenBranch_Statement" LowerBound="271.1" HigherBound="273.50">
                                                <om:Property Name="Timeout" Value="// Timeout in milliseconds...&#xD;&#xA;new System.TimeSpan(0, 0, 0, 0, pmntTrackTimeout)" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="SetTimeoutPeriod" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="df258746-f679-45c1-9fd7-7a059cc81f2e" ParentLink="ComplexStatement_Statement" LowerBound="285.1" HigherBound="304.1">
                                        <om:Property Name="Expression" Value="// Calculate the response time&#xD;&#xA;endLastPaymentTime = System.DateTime.Now;&#xD;&#xA;lastPaymentDuration = endLastPaymentTime.Subtract(beginLastPaymentTime);&#xD;&#xA;&#xD;&#xA;// Create the BAM milestones...&#xD;&#xA;if (errorLastPayments)&#xD;&#xA;{&#xD;&#xA;    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackLastPaymentError(activityID, &#xD;&#xA;           System.Convert.ToInt32(lastPaymentDuration.TotalMilliseconds), &#xD;&#xA;           LastPaymentResponse.ResponseStatus.Error.ErrorNumber, &#xD;&#xA;           LastPaymentResponse.ResponseStatus.Error.ErrorDescription,&#xD;&#xA;           LastPaymentResponse.ResponseStatus.Error.ErrorSource);&#xD;&#xA;}&#xD;&#xA;else&#xD;&#xA;{&#xD;&#xA;    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackLastPaymentSuccess(activityID, &#xD;&#xA;          System.Convert.ToInt32(lastPaymentDuration.TotalMilliseconds));&#xD;&#xA;}" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="CreateBAMMilestones" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="ParallelBranch" OID="b76c5285-8e1f-4305-8994-53a942bf5589" ParentLink="ReallyComplexStatement_Branch" LowerBound="307.1" HigherBound="377.1">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParallelBranch_3" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="53076f8f-e094-4afb-a6f3-e554bc32f6da" ParentLink="ComplexStatement_Statement" LowerBound="307.1" HigherBound="320.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructPendingTransactionsRequest" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Transform" OID="f32c0473-d005-4979-b207-48bb0e8cb8d3" ParentLink="ComplexStatement_Statement" LowerBound="310.1" HigherBound="312.1">
                                            <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_PendingTransactionsRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="CreatePendingTransactionsRequest" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessagePartRef" OID="832c07dc-215a-4ee3-9c0a-a6488bd6d9bc" ParentLink="Transform_InputMessagePartRef" LowerBound="311.177" HigherBound="311.199">
                                                <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_7" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="98752e6e-71d8-4518-a62d-a681e83c6788" ParentLink="Transform_OutputMessagePartRef" LowerBound="311.48" HigherBound="311.74">
                                                <om:Property Name="MessageRef" Value="PendingTransactionsRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_8" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="645a5e72-2df4-49ea-a781-0270a6d7f1f7" ParentLink="ComplexStatement_Statement" LowerBound="312.1" HigherBound="319.1">
                                            <om:Property Name="Expression" Value="PendingTransactionsWSRequest.PendingTransactionsRequest = PendingTransactionsRequest;&#xD;&#xA;&#xD;&#xA;// Copy the SSO Ticket and Originator ID so SSO can redeem the ticket and map it to the appropriate user...&#xD;&#xA;&#xD;&#xA;PendingTransactionsWSRequest(BTS.SSOTicket) = CustomerServiceRequest(BTS.SSOTicket);&#xD;&#xA;PendingTransactionsWSRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID) = CustomerServiceRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID);&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="CopyToWebServiceRequest" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="1dd85c68-e50b-4f39-b6d0-59990250431e" ParentLink="Construct_MessageRef" LowerBound="308.43" HigherBound="308.71">
                                            <om:Property Name="Ref" Value="PendingTransactionsWSRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="ef4f65c3-dcb3-4e4a-bf98-010c6b178bd6" ParentLink="Construct_MessageRef" LowerBound="308.73" HigherBound="308.99">
                                            <om:Property Name="Ref" Value="PendingTransactionsRequest" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="af03458c-6b94-4f7c-b103-54cd64e601d7" ParentLink="ComplexStatement_Statement" LowerBound="320.1" HigherBound="322.1">
                                        <om:Property Name="Expression" Value="beginPendingTransTime = System.DateTime.Now;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="AssignBeginTime" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Send" OID="bc6af274-e8e5-4249-8a0b-e8c00fb780bc" ParentLink="ComplexStatement_Statement" LowerBound="322.1" HigherBound="324.1">
                                        <om:Property Name="PortName" Value="PendingTransactionSystemRequestResponsePort" />
                                        <om:Property Name="MessageName" Value="PendingTransactionsWSRequest" />
                                        <om:Property Name="OperationName" Value="GetPendingTransactions" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="SendPendingTransactionsRequest" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Scope" OID="69464241-6ff7-4f4e-bf22-7f3ebdab9a29" ParentLink="ComplexStatement_Statement" LowerBound="324.1" HigherBound="359.1">
                                        <om:Property Name="InitializedTransactionType" Value="True" />
                                        <om:Property Name="IsSynchronized" Value="False" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="PendTransTimeoutDetectionScope" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="LongRunningTransaction" OID="0ff7b4be-9f88-41b6-8664-11669dcd0a3f" ParentLink="Scope_Transaction" LowerBound="325.38" HigherBound="325.156">
                                            <om:Property Name="TimeoutExpression" Value="new System.TimeSpan(0, 0, 0, 0, pendTransTimeout)" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ReceivePendTransResponseWithTimeout" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Receive" OID="f97bc638-6254-4a81-81c0-0a9c86dd8072" ParentLink="ComplexStatement_Statement" LowerBound="329.1" HigherBound="331.1">
                                            <om:Property Name="Activate" Value="False" />
                                            <om:Property Name="PortName" Value="PendingTransactionSystemRequestResponsePort" />
                                            <om:Property Name="MessageName" Value="PendingTransactionsWSResponse" />
                                            <om:Property Name="OperationName" Value="GetPendingTransactions" />
                                            <om:Property Name="OperationMessageName" Value="Response" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ReceivePendingTransactionResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="3b2fbc6c-59bc-4295-bc57-fbac85bed077" ParentLink="ComplexStatement_Statement" LowerBound="331.1" HigherBound="337.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="RetrieveResults" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="bb36c824-85c4-4f91-b31a-442c777b3f90" ParentLink="ComplexStatement_Statement" LowerBound="334.1" HigherBound="336.1">
                                                <om:Property Name="Expression" Value="PendingTransactionsResponse = PendingTransactionsWSResponse.GetPendingTransactionsResult;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="RetrieveResponseFromWebServiceResponse" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="f3697c18-b414-4d95-8c88-5903ffde5208" ParentLink="Construct_MessageRef" LowerBound="332.51" HigherBound="332.78">
                                                <om:Property Name="Ref" Value="PendingTransactionsResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="a64e6d71-9d08-48cb-b0b1-d485a932b75c" ParentLink="ComplexStatement_Statement" LowerBound="337.1" HigherBound="340.1">
                                            <om:Property Name="Expression" Value="// Error if the error code is not 0000&#xD;&#xA;errorPendingTransactions = PendingTransactionsResponse.ResponseStatus.Error.ErrorNumber != &quot;0000&quot;;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ExamineForErrors" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Catch" OID="e790e9e0-69c4-49e5-909a-3a0dfb32a46f" ParentLink="Scope_Catch" LowerBound="343.1" HigherBound="357.1">
                                            <om:Property Name="ExceptionName" Value="pendTransTimeoutException" />
                                            <om:Property Name="ExceptionType" Value="Microsoft.XLANGs.BaseTypes.TimeoutException" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="PendTransTimeoutHandler" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="42329370-a3cb-4552-b481-1a2fcb0ab105" ParentLink="Catch_Statement" LowerBound="346.1" HigherBound="348.1">
                                                <om:Property Name="Expression" Value="errorPendingTransactions = true;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="AssignTimeoutError" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="VariableAssignment" OID="66b2f087-ea3d-428c-9528-f8687c026db6" ParentLink="Catch_Statement" LowerBound="348.1" HigherBound="350.1">
                                                <om:Property Name="Expression" Value="System.Diagnostics.Trace.WriteLine(&quot;Timeout from the Pending Transactions Web Service&quot;);&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Trace" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="afc97035-eea2-4477-91bb-79bf059a2651" ParentLink="Catch_Statement" LowerBound="350.1" HigherBound="356.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructPendTransRespWithTimeoutError" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="20373a6a-4b1b-48b3-86d2-fe4ec23a6ac7" ParentLink="Construct_MessageRef" LowerBound="351.55" HigherBound="351.82">
                                                    <om:Property Name="Ref" Value="PendingTransactionsResponse" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="44b4cb65-05bc-430e-9a4f-c55e5aa36d50" ParentLink="ComplexStatement_Statement" LowerBound="353.1" HigherBound="355.1">
                                                    <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_PendingTransactionResponse" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="CreatePendTransRespWithTimeoutError" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="73a977b1-cdf1-44ea-9a06-035ee710713b" ParentLink="Transform_InputMessagePartRef" LowerBound="354.190" HigherBound="354.212">
                                                        <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_25" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="2ae33ced-aa88-443a-b11a-9357edb7c78e" ParentLink="Transform_OutputMessagePartRef" LowerBound="354.60" HigherBound="354.87">
                                                        <om:Property Name="MessageRef" Value="PendingTransactionsResponse" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_26" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="5436e432-f22a-4a90-a013-7837308e5ae8" ParentLink="ComplexStatement_Statement" LowerBound="359.1" HigherBound="377.1">
                                        <om:Property Name="Expression" Value="endPendingTransTime = System.DateTime.Now;&#xD;&#xA;pendingTransDuration = endPendingTransTime.Subtract(beginPendingTransTime);&#xD;&#xA;&#xD;&#xA;// Create the BAM milestones...&#xD;&#xA;if (errorPendingTransactions)&#xD;&#xA;{&#xD;&#xA;    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackPendingTransactionsError(activityID, &#xD;&#xA;           System.Convert.ToInt32(pendingTransDuration.TotalMilliseconds), &#xD;&#xA;           PendingTransactionsResponse.ResponseStatus.Error.ErrorNumber,&#xD;&#xA;           PendingTransactionsResponse.ResponseStatus.Error.ErrorDescription,&#xD;&#xA;           PendingTransactionsResponse.ResponseStatus.Error.ErrorSource);&#xD;&#xA;}&#xD;&#xA;else&#xD;&#xA;{&#xD;&#xA;    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackPendingTransactionsSuccess(activityID, &#xD;&#xA;          System.Convert.ToInt32(pendingTransDuration.TotalMilliseconds));&#xD;&#xA;}" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="CreateBAMMilestones" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="8f28fe58-ede9-428b-9684-19829e13ff0d" ParentLink="ComplexStatement_Statement" LowerBound="379.1" HigherBound="410.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CheckErrorAndAggregate" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="d8175eed-f72b-4a85-aaad-c9ab7bddab71" ParentLink="ReallyComplexStatement_Branch" LowerBound="380.25" HigherBound="395.1">
                                    <om:Property Name="Expression" Value="errorCreditLimit || errorLastPayments  || errorPendingTransactions " />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Error" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="016c0163-d398-4209-8dff-de0635ee5eb6" ParentLink="ComplexStatement_Statement" LowerBound="382.1" HigherBound="388.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructCustomerServiceErrorResponse" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="60166632-e821-4ef4-9066-d15674601cc7" ParentLink="Construct_MessageRef" LowerBound="383.39" HigherBound="383.62">
                                            <om:Property Name="Ref" Value="CustomerServiceResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="ba8919a6-451e-4738-90e2-b103e814a49c" ParentLink="ComplexStatement_Statement" LowerBound="385.1" HigherBound="387.1">
                                            <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.Aggregate_To_ErrorResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="AggregateErrorResponse" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="MessagePartRef" OID="baf921d4-f086-4122-af85-7bfa95413620" ParentLink="Transform_InputMessagePartRef" LowerBound="386.144" HigherBound="386.166">
                                                <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_14" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="028d08e1-f217-4796-b104-591f58aef3dc" ParentLink="Transform_InputMessagePartRef" LowerBound="386.168" HigherBound="386.187">
                                                <om:Property Name="MessageRef" Value="CreditLimitResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_15" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="1bdbc568-25f3-45fe-b3d5-bb1c0a76166f" ParentLink="Transform_InputMessagePartRef" LowerBound="386.189" HigherBound="386.208">
                                                <om:Property Name="MessageRef" Value="LastPaymentResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_16" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="7ff423a9-2abc-4b59-b5b1-0f6d668c62bd" ParentLink="Transform_InputMessagePartRef" LowerBound="386.210" HigherBound="386.237">
                                                <om:Property Name="MessageRef" Value="PendingTransactionsResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_18" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="dd32e75f-a03c-44ad-a60e-4223b4925a6c" ParentLink="Transform_OutputMessagePartRef" LowerBound="386.44" HigherBound="386.67">
                                                <om:Property Name="MessageRef" Value="CustomerServiceResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_17" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="1b838a2f-b0ea-469d-bda5-e7bfdb5ad245" ParentLink="ComplexStatement_Statement" LowerBound="388.1" HigherBound="394.1">
                                        <om:Property Name="Expression" Value="endTime = System.DateTime.Now;&#xD;&#xA;&#xD;&#xA;timeTaken = endTime.Subtract(beginTime);&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestCompleteError(activityID, System.Convert.ToInt32(timeTaken.TotalMilliseconds), CustomerServiceResponse.ResponseStatus.Error.ErrorNumber, CustomerServiceResponse.ResponseStatus.Error.ErrorDescription, CustomerServiceResponse.ResponseStatus.Error.ErrorSource);" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="CreateBAMMilestone" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="75ef3875-89ca-42b3-8569-c1ef91a05e6a" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="a76878e1-8856-47a7-a191-4fc82bd51560" ParentLink="ComplexStatement_Statement" LowerBound="397.1" HigherBound="403.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructCustomerServiceResponse" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="1a389471-7cc5-45a0-9682-efb51e6cb1df" ParentLink="Construct_MessageRef" LowerBound="398.39" HigherBound="398.62">
                                            <om:Property Name="Ref" Value="CustomerServiceResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="2dd1f67c-a7ba-4671-bbf3-719a5833e5ae" ParentLink="ComplexStatement_Statement" LowerBound="400.1" HigherBound="402.1">
                                            <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.Aggregate_To_CustomerServiceResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="AggregateCustomerServiceResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessagePartRef" OID="d57af26e-24d3-4e52-bebb-9f5bd915e977" ParentLink="Transform_InputMessagePartRef" LowerBound="401.154" HigherBound="401.176">
                                                <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_9" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="cdfd7ae5-6185-4a60-b07f-8554ba00f707" ParentLink="Transform_InputMessagePartRef" LowerBound="401.178" HigherBound="401.197">
                                                <om:Property Name="MessageRef" Value="CreditLimitResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_10" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="85b8ae29-7d1b-4642-aa06-c0287905a840" ParentLink="Transform_InputMessagePartRef" LowerBound="401.199" HigherBound="401.218">
                                                <om:Property Name="MessageRef" Value="LastPaymentResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_11" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="eebbb357-fefc-4c9e-b842-93be9ccc7319" ParentLink="Transform_InputMessagePartRef" LowerBound="401.220" HigherBound="401.247">
                                                <om:Property Name="MessageRef" Value="PendingTransactionsResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_12" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="60161ab6-50d2-419e-9332-0d396d7249c0" ParentLink="Transform_OutputMessagePartRef" LowerBound="401.44" HigherBound="401.67">
                                                <om:Property Name="MessageRef" Value="CustomerServiceResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_13" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="2b60c131-8c2c-4151-97fc-fedb5992423a" ParentLink="ComplexStatement_Statement" LowerBound="403.1" HigherBound="409.1">
                                        <om:Property Name="Expression" Value="endTime = System.DateTime.Now;&#xD;&#xA;&#xD;&#xA;timeTaken = endTime.Subtract(beginTime);&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestCompleteSuccess(activityID, System.Convert.ToInt32(timeTaken.TotalMilliseconds));" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="CreateBAMMilestone" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="60048bcd-be0c-497f-aecf-9d7b7a2ce6a0" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="08f742ea-f0e0-4d8b-896b-684731d7bc43" ParentLink="ComplexStatement_Statement" LowerBound="413.1" HigherBound="423.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructRequestDenied" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Transform" OID="490182b9-8bd4-4068-8252-cfe99b3af189" ParentLink="ComplexStatement_Statement" LowerBound="416.1" HigherBound="418.1">
                                    <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CustomerServiceResponseDenied" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CreateRequestDenied" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="MessagePartRef" OID="4fef3b27-b2ac-4955-9981-e89766f1f942" ParentLink="Transform_InputMessagePartRef" LowerBound="417.169" HigherBound="417.191">
                                        <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="d635f659-2687-4787-a3b8-2572010db183" ParentLink="Transform_OutputMessagePartRef" LowerBound="417.40" HigherBound="417.63">
                                        <om:Property Name="MessageRef" Value="CustomerServiceResponse" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="a35ceca6-1e88-49d6-b08c-c376f576aa45" ParentLink="ComplexStatement_Statement" LowerBound="418.1" HigherBound="422.1">
                                    <om:Property Name="Expression" Value="CustomerServiceResponse.ResponseStatus.Error.ErrorNumber = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceInvalidRequest  ;&#xD;&#xA;CustomerServiceResponse.ResponseStatus.Error.ErrorDescription = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorDescription(Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceInvalidRequest);&#xD;&#xA;CustomerServiceResponse.ResponseStatus.Error.ErrorSource = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorSource(Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceInvalidRequest);" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="AssignErrorInformation" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="d308270e-6d3d-4eb1-bb20-f2eb4fe677c6" ParentLink="Construct_MessageRef" LowerBound="414.35" HigherBound="414.58">
                                    <om:Property Name="Ref" Value="CustomerServiceResponse" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="eaeb8ca5-7eb3-4186-b697-f817f7ab9786" ParentLink="ComplexStatement_Statement" LowerBound="423.1" HigherBound="429.1">
                                <om:Property Name="Expression" Value="endTime = System.DateTime.Now;&#xD;&#xA;&#xD;&#xA;timeTaken = endTime.Subtract(beginTime);&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackInvalidRequest(activityID, System.Convert.ToInt32(timeTaken.TotalMilliseconds));" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CreateBAMMielstone" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="e30dba98-c39b-4a4d-b22d-8fadf7e0d5fa" ParentLink="ComplexStatement_Statement" LowerBound="430.1" HigherBound="433.1">
                        <om:Property Name="Expression" Value="// Complete the activity...&#xD;&#xA;Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.EndRequest(activityID);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="EndActivity" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Catch" OID="14ddda60-0c5a-4b40-9e50-c78bac1f6898" ParentLink="Scope_Catch" LowerBound="436.1" HigherBound="470.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CustomerServiceExceptionHandler" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Decision" OID="0e024d82-7ef4-435f-b4a0-335b26184a5d" ParentLink="Catch_Statement" LowerBound="439.1" HigherBound="457.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="checkForActivity" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="28195c9f-2a88-497c-a2f3-38a793b7bd47" ParentLink="ReallyComplexStatement_Branch" LowerBound="440.25" HigherBound="457.1">
                                <om:Property Name="Expression" Value="activityID != null" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Activity Began" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="VariableAssignment" OID="0c6f178b-8d7b-46e9-b07e-fba34dc2f0bf" ParentLink="ComplexStatement_Statement" LowerBound="442.1" HigherBound="456.1">
                                    <om:Property Name="Expression" Value="&#xD;&#xA;// An Exception is treated as an error from the BAM perspective...&#xD;&#xA;&#xD;&#xA;Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestCompleteError(&#xD;&#xA;                            activityID, &#xD;&#xA;                            0, &#xD;&#xA;                            Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceExceptionError,&#xD;&#xA;                            ex.Message, &#xD;&#xA;                            &quot;Customer Service Orchestration&quot;&#xD;&#xA;        );&#xD;&#xA;&#xD;&#xA;// Complete the activity...&#xD;&#xA;Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.EndRequest(activityID);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="EndActivityInException" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="c13b7bdb-a16c-4fa7-a0d0-04ff8daac31f" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="c4a84fe9-48c4-42bd-bc59-398ed778c745" ParentLink="Catch_Statement" LowerBound="457.1" HigherBound="459.1">
                            <om:Property Name="Expression" Value="System.Diagnostics.Trace.Write(&quot;Exception in Orchestration: &quot; + ex.ToString());" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="TraceException" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="c5928f37-54e8-4c7e-8ed6-20dff27e150b" ParentLink="Catch_Statement" LowerBound="459.1" HigherBound="469.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="RespondUnderException" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Transform" OID="59c3d483-4449-424a-b9eb-89ec28bc4b79" ParentLink="ComplexStatement_Statement" LowerBound="462.1" HigherBound="464.1">
                                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CustomerServiceResponseDenied" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CreateResponseForException" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessagePartRef" OID="e579a962-9d1f-485f-813e-3500e34304da" ParentLink="Transform_InputMessagePartRef" LowerBound="463.169" HigherBound="463.191">
                                    <om:Property Name="MessageRef" Value="CustomerServiceRequest" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_19" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="64a391bf-7118-4ef3-8a6c-c2266ada2c0d" ParentLink="Transform_OutputMessagePartRef" LowerBound="463.40" HigherBound="463.63">
                                    <om:Property Name="MessageRef" Value="CustomerServiceResponse" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_20" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="56014054-2e86-47ee-b5a5-c93cdcffd500" ParentLink="ComplexStatement_Statement" LowerBound="464.1" HigherBound="468.1">
                                <om:Property Name="Expression" Value="CustomerServiceResponse.ResponseStatus.Error.ErrorNumber = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceExceptionError;&#xD;&#xA;CustomerServiceResponse.ResponseStatus.Error.ErrorDescription = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorDescription(ex);&#xD;&#xA;CustomerServiceResponse.ResponseStatus.Error.ErrorSource = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorSource(Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceExceptionError);" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="AssignErrorInfo" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="2718da25-bdb4-47f1-87ce-cfddd40dadfe" ParentLink="Construct_MessageRef" LowerBound="460.35" HigherBound="460.58">
                                <om:Property Name="Ref" Value="CustomerServiceResponse" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="cefb164f-4d21-4832-8ba0-802b5e93dfc2" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="39.1" HigherBound="41.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.PaymentTrackingSystemRequestPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PaymentTrackingSystemRequestPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="4e97e96a-f921-49c2-aba1-14ad9986282e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="39.1" HigherBound="40.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="18e04eb0-7862-4711-b09d-ee4881ca1c41" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="41.1" HigherBound="43.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.PaymentTrackingSystemResponsePortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PaymentTrackingSystemResponsePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="86245bdc-ddc9-4089-bfe2-12364cfe4f44" ParentLink="PortDeclaration_CLRAttribute" LowerBound="41.1" HigherBound="42.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="cebaa5e1-d964-4e73-b768-c01e06a88c84" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="43.1" HigherBound="45.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="30" />
                <om:Property Name="IsWebPort" Value="True" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.PendTransWS.PendingTransactionsWebService_.PendingTransactionsWebService" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PendingTransactionSystemRequestResponsePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="a7111083-ff67-4b48-9dce-34ab8f512b9f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="43.1" HigherBound="44.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="e0e4a7fe-f95b-44df-85da-73ad69985605" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="45.1" HigherBound="47.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="True" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter.StubSAPWS.StubSAPWS_.StubSAPWS" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="StubSAPWebServicePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="b6b214f4-ed67-4de7-b227-0c79c2b986b1" ParentLink="PortDeclaration_CLRAttribute" LowerBound="45.1" HigherBound="46.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="CorrelationType" OID="8d9fba7d-6509-4827-ad26-db0edbddf42c" ParentLink="Module_CorrelationType" LowerBound="32.1" HigherBound="36.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PaymentTrackingSystemCorrelationType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PropertyRef" OID="99868064-5c89-4c12-81f6-1942e7de4eb0" ParentLink="CorrelationType_PropertyRef" LowerBound="34.9" HigherBound="34.31">
                <om:Property Name="Ref" Value="MQSeries.MQMD_CorrelId" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PropertyRef_1" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Microsoft.Samples.BizTalk.WoodgroveBank.Orchestrations.Adapter
{
    public porttype CustomerServicePortType
    {
        requestresponse GetAccountInfo
        {
            Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceRequest, Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceResponse
        };
    };
    internal porttype PaymentTrackingSystemRequestPortType
    {
        oneway SendPmtTrackRequest
        {
            Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentRequest
        };
    };
    internal porttype PaymentTrackingSystemResponsePortType
    {
        oneway ReceivePmtTrackRespone
        {
            Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentResponse
        };
    };
    internal porttype SAPPortType
    {
        requestresponse SAPRequestResponse
        {
            Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Request, Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Response
        };
    };
    internal correlationtype PaymentTrackingSystemCorrelationType
    {
        MQSeries.MQMD_CorrelId
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service longrunning transaction CustomerService
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PaymentTrackingSystemRequestPortType PaymentTrackingSystemRequestPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PaymentTrackingSystemResponsePortType PaymentTrackingSystemResponsePort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PendTransWS.PendingTransactionsWebService_.PendingTransactionsWebService PendingTransactionSystemRequestResponsePort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses StubSAPWS.StubSAPWS_.StubSAPWS StubSAPWebServicePort;
        correlation PaymentTrackingSystemCorrelationType PaymentTrackingSystemCorrelation;
        message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentRequest LastPaymentRequest;
        message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.LastPaymentResponse LastPaymentResponse;
        message PendTransWS.PendingTransactionsWebService_.GetPendingTransactions_request PendingTransactionsWSRequest;
        message PendTransWS.PendingTransactionsWebService_.GetPendingTransactions_response PendingTransactionsWSResponse;
        message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Request CreditLimitRequest;
        message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.BAPI_BANKACCT_GET_DETAIL.BAPI_BANKACCT_GET_DETAIL_Response CreditLimitResponse;
        message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.PendingTransactionsRequest PendingTransactionsRequest;
        message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.PendingTransactionsResponse PendingTransactionsResponse;
        message StubSAPWS.StubSAPWS_.GetAccountDetails_request StubSAPWebServiceRequest;
        message StubSAPWS.StubSAPWS_.GetAccountDetails_response StubSAPWebServiceResponse;
        System.String accountNumber;
        System.String customerName;
        System.String zipCode;
        System.Boolean RequestIsValid;
        System.Boolean errorLastPayments;
        System.Boolean errorPendingTransactions;
        System.Boolean errorCreditLimit;
        System.DateTime beginCreditLimitTime;
        System.DateTime endCreditLimitTime;
        System.DateTime beginLastPaymentTime;
        System.DateTime endLastPaymentTime;
        System.DateTime beginPendingTransTime;
        System.DateTime endPendingTransTime;
        System.TimeSpan creditLimitDuration;
        System.TimeSpan lastPaymentDuration;
        System.TimeSpan pendingTransDuration;
        System.String activityID;
        System.DateTime beginTime;
        System.DateTime endTime;
        System.TimeSpan timeTaken;
        System.String sapReturnCode;
        System.Int32 sapTimeout;
        System.Int32 pendTransTimeout;
        System.Int32 pmntTrackTimeout;
        body (message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceRequest CustomerServiceRequest, out message Microsoft.Samples.BizTalk.WoodgroveBank.Schemas.CustomerServiceResponse CustomerServiceResponse)
        {
            accountNumber = "";
            customerName = "";
            zipCode = "";
            RequestIsValid = true;
            errorLastPayments = true;
            errorPendingTransactions = true;
            errorCreditLimit = true;
            activityID = null;
            sapReturnCode = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fd1b8c03-9639-45f2-a5d8-4ec620f6f729")]
            scope longrunning transaction CustomerServiceTransaction
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1be60852-ac5a-451f-8512-48e7b37bf9a8")]
                    // Begin the BAM activity
                    
                    activityID = Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.BeginRequest(CustomerServiceRequest.RequestSource, CustomerServiceRequest.RequestType);
                    
                    // Save starting time for later computing response times...
                    beginTime = System.DateTime.Now;
                    
                    // Request Received Milestone
                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestReceived(activityID);
                            
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("130f66ca-1ac6-4b47-b0a7-ae2875d2ff1c")]
                    sapTimeout = System.Convert.ToInt32 (
                            Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.GetConfigParameter(
                                Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.SsoConfigParameter.SapAdapterTimeout),
                            System.Globalization.CultureInfo.CurrentCulture);
                    pendTransTimeout = System.Convert.ToInt32(
                            Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.GetConfigParameter(
                                Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.SsoConfigParameter.PendingTransactionsAdapterTimeout),
                            System.Globalization.CultureInfo.CurrentCulture);
                    pmntTrackTimeout = System.Convert.ToInt32(
                            Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.GetConfigParameter(
                                Microsoft.Samples.BizTalk.WoodgroveBank.ConfigHelper.ConfigParameters.SsoConfigParameter.PaymentTrackingAdapterTimeout),
                            System.Globalization.CultureInfo.CurrentCulture);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("618154cb-f61d-4a73-8ab5-064e94804239")]
                    // Validate the input request based on the contents of the AuthenticationInfo element.
                    // The AuthenticationInfo elements contains name/value pairs for authenticating the customer
                    // We must either have a ZipCode or a CustomerName to declare that this a valid request.
                    // Validating the message based on the contents of the request is done in one or more
                    // of the back end systems...
                    
                    customerName  = xpath(CustomerServiceRequest, 
                    "string(/*[local-name()='CustomerServiceRequest']/*[local-name()='Body']/*[local-name()='AuthenticationInfo'][DataElementName='CustomerName']/*[local-name()='DataElementValue'])");
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("60cf248e-f3e1-4140-8206-cf7a44606e1f")]
                    //Get the zipCode out of the message...
                    
                    zipCode = xpath(CustomerServiceRequest, 
                    "string(/*[local-name()='CustomerServiceRequest']/*[local-name()='Body']/*[local-name()='AuthenticationInfo'][DataElementName='ZipCode']/*[local-name()='DataElementValue'])");
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b7f38687-db78-4561-b29b-4395ef2d1d3d")]
                    //Get the Account Number out of the message...
                    
                    accountNumber = CustomerServiceRequest.Body.AccountNumber;
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("38ded481-39cf-494e-b7eb-4c7bcb85d0f2")]
                    // One of the authentication values must be there in the message in order to proceed
                    // And the account number must be there also.
                    // And the account number must be valid...
                    RequestIsValid = (zipCode != "" || customerName != "") && 
                                        accountNumber != "" &&
                                        Microsoft.Samples.BizTalk.WoodgroveBank.Utilities.CustomerServiceHelper.IsAccountNumberValid(accountNumber) ;
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a906930a-c276-4e60-8dee-82e85786f2bb")]
                    if (RequestIsValid )
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fa8184fc-286c-4670-916a-11e9f805a7f5")]
                        parallel
                        {
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e5169b60-24d6-4885-af33-74d9102ed252")]
                                construct CreditLimitRequest, StubSAPWebServiceRequest
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb744ab2-e9b3-4b23-9c31-587adb18ce5c")]
                                    transform (CreditLimitRequest) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CreditLimiRequest (CustomerServiceRequest);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("07a32244-fdf2-45df-ad56-c8fafa998950")]
                                    StubSAPWebServiceRequest.BAPI_BANKACCT_GET_DETAIL_Request = CreditLimitRequest;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2afe7bce-0978-49fe-b1be-cd744645d460")]
                                beginCreditLimitTime = System.DateTime.Now;
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("8661661c-ee61-4718-868a-64f00a60960d")]
                                send (StubSAPWebServicePort.GetAccountDetails, StubSAPWebServiceRequest);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ba9f57c2-44d7-4eff-88dd-7fca8f0b19a7")]
                                scope longrunning transaction ReceiveSAPResponseWithinTime timeout new System.TimeSpan(0, 0, 0, 0, sapTimeout )
                                {
                                    body
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd87bfd0-ecdd-4f63-9390-b109101bf0b2")]
                                        receive (StubSAPWebServicePort.GetAccountDetails, StubSAPWebServiceResponse);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f181fd4e-d148-40c5-9d7d-beefc8573fda")]
                                        construct CreditLimitResponse
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3f0a1087-3e71-4f31-aabd-35e6cbcbd12c")]
                                            CreditLimitResponse = StubSAPWebServiceResponse.GetAccountDetailsResult;
                                        }
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cbe12065-a1d1-45ee-8bdd-8ac586ab85bd")]
                                        // Examine the SAP return code
                                        
                                        sapReturnCode = (System.String) xpath(CreditLimitResponse, 
                                        "string(/*[local-name()='BAPI_BANKACCT_GET_DETAIL_Response']/*[local-name()='E_RC'])");
                                        
                                        errorCreditLimit = sapReturnCode != "";
                                    }
                                    exceptions
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4a269b78-ebe2-44e2-802c-255f0f38ef94")]
                                        catch (Microsoft.XLANGs.BaseTypes.TimeoutException sapTimeoutException)
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("806b0e50-c920-4416-aada-c4b32c6028e2")]
                                            errorCreditLimit = true;
                                            
                                            sapReturnCode = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.SapTimeoutErrorCode() ;
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e98d186c-5480-4047-9e14-9cd9c559af67")]
                                            System.Diagnostics.Trace.WriteLine("Timeout from SAP");
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ce80b779-0457-4dc7-839a-2927743656e0")]
                                            construct CreditLimitResponse
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("26da375a-e313-43e7-86ca-bbbaed50b7a3")]
                                                transform (CreditLimitResponse) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CreditLimitResponse (CustomerServiceRequest);
                                            }
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("56ec757c-a262-4927-883f-100f0ed0d429")]
                                            System.Diagnostics.Trace.WriteLine("Constructed SAP Response Message");
                                            
                                            //xd1 = CreditLimitResponse ;
                                            //System.Diagnostics.Trace.Write("CreditLimitResponse = " + xd1.OuterXml);
                                        }
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bcb6269f-e823-436f-8cfd-71a71579f727")]
                                endCreditLimitTime = System.DateTime.Now;
                                creditLimitDuration = endCreditLimitTime.Subtract(beginCreditLimitTime);
                                
                                // Create the appropriate BAM milestones...
                                if (errorCreditLimit)
                                {
                                    // Map SAP return code to appropriate descriptions here...
                                
                                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackCreditLimitError
                                       (
                                           activityID, 
                                           System.Convert.ToInt32(creditLimitDuration.TotalMilliseconds),
                                           sapReturnCode,
                                           Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.DecodeSapErrorCodeToDescription(sapReturnCode),
                                           Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.DecodeSapErrorCodeToSource(sapReturnCode)
                                       );       
                                }
                                else
                                {
                                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackCreditLimitSuccess(activityID, 
                                          System.Convert.ToInt32(creditLimitDuration.TotalMilliseconds));
                                }
                            }
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("85e96c88-a9d9-453e-ae0a-5262afe657ee")]
                                construct LastPaymentRequest
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("21089c4b-bf08-469e-bf30-9fc772892925")]
                                    transform (LastPaymentRequest) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_LastPaymentRequest (CustomerServiceRequest);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("116fbcee-e496-4a6e-b05b-0aae90c154c8")]
                                    // Assign the MQSerirs Message ID and Correlation ID
                                    // Generate a unique id for the message. MQ Series message ids are 48 characters long.
                                    LastPaymentRequest(MQSeries.MQMD_MsgId) = Microsoft.Samples.BizTalk.WoodgroveBank.Utilities.CustomerServiceHelper.NewUniqueIdAppendToLength(48, '0');
                                    LastPaymentRequest(MQSeries.MQMD_CorrelId) = LastPaymentRequest(MQSeries.MQMD_MsgId);
                                    
                                    // Copy the SSO Ticket and the originator SID to the message so SSO can
                                    // happily redeem the ticket later.
                                    LastPaymentRequest(BTS.SSOTicket) = CustomerServiceRequest(BTS.SSOTicket);
                                    LastPaymentRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID) = CustomerServiceRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID);
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("39967bb6-4dd3-4453-b118-99546b29931c")]
                                beginLastPaymentTime = System.DateTime.Now;
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("86e01136-5dc3-4cdb-ba81-5b436c87a245")]
                                send (PaymentTrackingSystemRequestPort.SendPmtTrackRequest, LastPaymentRequest, initialize PaymentTrackingSystemCorrelation);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e2dfc04c-e627-4aca-9fe6-4c51b01cd51d")]
                                listen
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("53a8c1fb-5e5b-4409-9152-b5dcdf23bb41")]
                                    until receive (PaymentTrackingSystemResponsePort.ReceivePmtTrackRespone, LastPaymentResponse, PaymentTrackingSystemCorrelation)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2db9b3da-2100-4802-bf11-629a060fc22d")]
                                        // Check for errors
                                        errorLastPayments = LastPaymentResponse.ResponseStatus.Error.ErrorNumber != "0000";
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a1553520-6bd2-4c78-bfa2-3d66c2ba0888")]
                                    timeout // Timeout in milliseconds...
new System.TimeSpan(0, 0, 0, 0, pmntTrackTimeout)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f2aff78b-eae2-464b-a90e-ab385b65070b")]
                                        errorLastPayments = true;
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c6ac8d1d-a8a2-473d-b588-d9c8b24104fe")]
                                        construct LastPaymentResponse
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7dfaa9cc-e408-4d4e-9672-71f773885f54")]
                                            transform (LastPaymentResponse) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_LastPaymentResponseTimeout (CustomerServiceRequest);
                                        }
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("df258746-f679-45c1-9fd7-7a059cc81f2e")]
                                // Calculate the response time
                                endLastPaymentTime = System.DateTime.Now;
                                lastPaymentDuration = endLastPaymentTime.Subtract(beginLastPaymentTime);
                                
                                // Create the BAM milestones...
                                if (errorLastPayments)
                                {
                                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackLastPaymentError(activityID, 
                                           System.Convert.ToInt32(lastPaymentDuration.TotalMilliseconds), 
                                           LastPaymentResponse.ResponseStatus.Error.ErrorNumber, 
                                           LastPaymentResponse.ResponseStatus.Error.ErrorDescription,
                                           LastPaymentResponse.ResponseStatus.Error.ErrorSource);
                                }
                                else
                                {
                                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackLastPaymentSuccess(activityID, 
                                          System.Convert.ToInt32(lastPaymentDuration.TotalMilliseconds));
                                }
                            }
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("53076f8f-e094-4afb-a6f3-e554bc32f6da")]
                                construct PendingTransactionsWSRequest, PendingTransactionsRequest
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f32c0473-d005-4979-b207-48bb0e8cb8d3")]
                                    transform (PendingTransactionsRequest) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_PendingTransactionsRequest (CustomerServiceRequest);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("645a5e72-2df4-49ea-a781-0270a6d7f1f7")]
                                    PendingTransactionsWSRequest.PendingTransactionsRequest = PendingTransactionsRequest;
                                    
                                    // Copy the SSO Ticket and Originator ID so SSO can redeem the ticket and map it to the appropriate user...
                                    
                                    PendingTransactionsWSRequest(BTS.SSOTicket) = CustomerServiceRequest(BTS.SSOTicket);
                                    PendingTransactionsWSRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID) = CustomerServiceRequest(Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("af03458c-6b94-4f7c-b103-54cd64e601d7")]
                                beginPendingTransTime = System.DateTime.Now;
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bc6af274-e8e5-4249-8a0b-e8c00fb780bc")]
                                send (PendingTransactionSystemRequestResponsePort.GetPendingTransactions, PendingTransactionsWSRequest);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("69464241-6ff7-4f4e-bf22-7f3ebdab9a29")]
                                scope longrunning transaction ReceivePendTransResponseWithTimeout timeout new System.TimeSpan(0, 0, 0, 0, pendTransTimeout)
                                {
                                    body
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f97bc638-6254-4a81-81c0-0a9c86dd8072")]
                                        receive (PendingTransactionSystemRequestResponsePort.GetPendingTransactions, PendingTransactionsWSResponse);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3b2fbc6c-59bc-4295-bc57-fbac85bed077")]
                                        construct PendingTransactionsResponse
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bb36c824-85c4-4f91-b31a-442c777b3f90")]
                                            PendingTransactionsResponse = PendingTransactionsWSResponse.GetPendingTransactionsResult;
                                        }
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a64e6d71-9d08-48cb-b0b1-d485a932b75c")]
                                        // Error if the error code is not 0000
                                        errorPendingTransactions = PendingTransactionsResponse.ResponseStatus.Error.ErrorNumber != "0000";
                                    }
                                    exceptions
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e790e9e0-69c4-49e5-909a-3a0dfb32a46f")]
                                        catch (Microsoft.XLANGs.BaseTypes.TimeoutException pendTransTimeoutException)
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("42329370-a3cb-4552-b481-1a2fcb0ab105")]
                                            errorPendingTransactions = true;
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("66b2f087-ea3d-428c-9528-f8687c026db6")]
                                            System.Diagnostics.Trace.WriteLine("Timeout from the Pending Transactions Web Service");
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("afc97035-eea2-4477-91bb-79bf059a2651")]
                                            construct PendingTransactionsResponse
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("44b4cb65-05bc-430e-9a4f-c55e5aa36d50")]
                                                transform (PendingTransactionsResponse) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_PendingTransactionResponse (CustomerServiceRequest);
                                            }
                                        }
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5436e432-f22a-4a90-a013-7837308e5ae8")]
                                endPendingTransTime = System.DateTime.Now;
                                pendingTransDuration = endPendingTransTime.Subtract(beginPendingTransTime);
                                
                                // Create the BAM milestones...
                                if (errorPendingTransactions)
                                {
                                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackPendingTransactionsError(activityID, 
                                           System.Convert.ToInt32(pendingTransDuration.TotalMilliseconds), 
                                           PendingTransactionsResponse.ResponseStatus.Error.ErrorNumber,
                                           PendingTransactionsResponse.ResponseStatus.Error.ErrorDescription,
                                           PendingTransactionsResponse.ResponseStatus.Error.ErrorSource);
                                }
                                else
                                {
                                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackPendingTransactionsSuccess(activityID, 
                                          System.Convert.ToInt32(pendingTransDuration.TotalMilliseconds));
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8f28fe58-ede9-428b-9684-19829e13ff0d")]
                        if (errorCreditLimit || errorLastPayments  || errorPendingTransactions )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("016c0163-d398-4209-8dff-de0635ee5eb6")]
                            construct CustomerServiceResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ba8919a6-451e-4738-90e2-b103e814a49c")]
                                transform (CustomerServiceResponse) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.Aggregate_To_ErrorResponse (CustomerServiceRequest, CreditLimitResponse, LastPaymentResponse, PendingTransactionsResponse);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1b838a2f-b0ea-469d-bda5-e7bfdb5ad245")]
                            endTime = System.DateTime.Now;
                            
                            timeTaken = endTime.Subtract(beginTime);
                            
                            Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestCompleteError(activityID, System.Convert.ToInt32(timeTaken.TotalMilliseconds), CustomerServiceResponse.ResponseStatus.Error.ErrorNumber, CustomerServiceResponse.ResponseStatus.Error.ErrorDescription, CustomerServiceResponse.ResponseStatus.Error.ErrorSource);
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a76878e1-8856-47a7-a191-4fc82bd51560")]
                            construct CustomerServiceResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2dd1f67c-a7ba-4671-bbf3-719a5833e5ae")]
                                transform (CustomerServiceResponse) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.Aggregate_To_CustomerServiceResponse (CustomerServiceRequest, CreditLimitResponse, LastPaymentResponse, PendingTransactionsResponse);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2b60c131-8c2c-4151-97fc-fedb5992423a")]
                            endTime = System.DateTime.Now;
                            
                            timeTaken = endTime.Subtract(beginTime);
                            
                            Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestCompleteSuccess(activityID, System.Convert.ToInt32(timeTaken.TotalMilliseconds));
                        }
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("08f742ea-f0e0-4d8b-896b-684731d7bc43")]
                        construct CustomerServiceResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("490182b9-8bd4-4068-8252-cfe99b3af189")]
                            transform (CustomerServiceResponse) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CustomerServiceResponseDenied (CustomerServiceRequest);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a35ceca6-1e88-49d6-b08c-c376f576aa45")]
                            CustomerServiceResponse.ResponseStatus.Error.ErrorNumber = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceInvalidRequest  ;
                            CustomerServiceResponse.ResponseStatus.Error.ErrorDescription = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorDescription(Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceInvalidRequest);
                            CustomerServiceResponse.ResponseStatus.Error.ErrorSource = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorSource(Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceInvalidRequest);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("eaeb8ca5-7eb3-4186-b697-f817f7ab9786")]
                        endTime = System.DateTime.Now;
                        
                        timeTaken = endTime.Subtract(beginTime);
                        
                        Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackInvalidRequest(activityID, System.Convert.ToInt32(timeTaken.TotalMilliseconds));
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e30dba98-c39b-4a4d-b22d-8fadf7e0d5fa")]
                    // Complete the activity...
                    Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.EndRequest(activityID);
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("14ddda60-0c5a-4b40-9e50-c78bac1f6898")]
                    catch (System.Exception ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0e024d82-7ef4-435f-b4a0-335b26184a5d")]
                        if (activityID != null)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0c6f178b-8d7b-46e9-b07e-fba34dc2f0bf")]
                            
                            // An Exception is treated as an error from the BAM perspective...
                            
                            Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.TrackRequestCompleteError(
                                                        activityID, 
                                                        0, 
                                                        Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceExceptionError,
                                                        ex.Message, 
                                                        "Customer Service Orchestration"
                                    );
                            
                            // Complete the activity...
                            Microsoft.Samples.BizTalk.WoodgroveBank.ServiceLevelTracking.ServiceLevelTracking.EndRequest(activityID);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c4a84fe9-48c4-42bd-bc59-398ed778c745")]
                        System.Diagnostics.Trace.Write("Exception in Orchestration: " + ex.ToString());
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c5928f37-54e8-4c7e-8ed6-20dff27e150b")]
                        construct CustomerServiceResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("59c3d483-4449-424a-b9eb-89ec28bc4b79")]
                            transform (CustomerServiceResponse) = Microsoft.Samples.BizTalk.WoodgroveBank.Maps.CustomerServiceRequest_To_CustomerServiceResponseDenied (CustomerServiceRequest);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("56014054-2e86-47ee-b5a5-c93cdcffd500")]
                            CustomerServiceResponse.ResponseStatus.Error.ErrorNumber = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceExceptionError;
                            CustomerServiceResponse.ResponseStatus.Error.ErrorDescription = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorDescription(ex);
                            CustomerServiceResponse.ResponseStatus.Error.ErrorSource = Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.GetCustomerServiceErrorSource(Microsoft.Samples.BizTalk.WoodgroveBank.ErrorHelper.CustomerServiceErrors.CustomerServiceExceptionError);
                        }
                    }
                }
            }
        }
    }
}

